{"version":3,"sources":["Components/ReaderControls/styles.module.scss","Components/Book/styles.module.scss","Pages/Library/styles.module.scss","Components/BookPlayer/styles.module.scss","Pages/Reader/styles.module.scss","Providers/Storage/index.tsx","utils/context.ts","Providers/index.tsx","assets/icons/cog-solid.svg","assets/icons/angle-left-solid.svg","Components/SingleWordRender/index.tsx","Components/BookPlayer/index.tsx","assets/icons/minus-solid.svg","assets/icons/plus-solid.svg","utils/wordTime.ts","Components/ReaderControls/index.tsx","Pages/Reader/index.tsx","Components/Book/index.tsx","Libraries/epub.ts","hooks/useFileInput.ts","Pages/Library/index.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["module","exports","defaultSettings","font","fontSize","wordsPerMinute","ctx","createContext","undefined","c","useContext","Error","Provider","createCtx","useStorageContext","StorageProvider","children","useState","loaded","setLoaded","settings","setSettings","library","setLibrary","loadSettings","useCallback","a","localforage","getItem","data","setItem","loadLibrary","addBook","bookInfo","find","item","id","console","log","content","cover","info","updatedLibrary","removeBook","getBookContent","getCurrentWordIndex","currentWordIndex","saveCurrentWordIndex","index","useEffect","value","Providers","Storage","_extends","Object","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","apply","this","_objectWithoutProperties","excluded","sourceKeys","keys","indexOf","_objectWithoutPropertiesLoose","getOwnPropertySymbols","sourceSymbolKeys","propertyIsEnumerable","fill","d","SvgCogSolid","_ref","svgRef","title","titleId","props","focusable","className","role","xmlns","viewBox","ref","ForwardRef","SvgAngleLeftSolid","SingleWordRender","word","split","Math","floor","ORP","lpad","rpad","padStart","substr","BookPart","bookText","startIndex","max","stopIndex","min","leftPart","slice","join","rightPart","styles","text","selected","BookPlayer","isPlaying","rawBookText","onPlayerClick","onClickHandler","container","cn","textPlayer","playing","onClick","SvgMinusSolid","SvgPlusSolid","completionRate","wordCount","toFixed","timeToRead","wordPerMinute","seconds1","temp","days","hours","minutes","seconds","secondsToStr","ReaderControls","speedDown","speedUp","togglePlay","wordsCount","currentIndex","completed","ttr","speedDownHanlder","e","preventDefault","stopPropagation","speedUpHanlder","topLine","controls","button","stats","bar","style","bottom","never","Number","MAX_SAFE_INTEGER","Reader","history","useHistory","setRawBookText","setBookText","setCurrentWordIndex","useParams","setTitle","then","speed","setSpeed","setPlaying","options","now","Date","getTime","started","setStarted","setCheckTime","nextFireTime","setNextFireTime","isStarted","isStopped","start","currentTime","newNextFireTime","delay","stop","timeout","overdueCalls","callback","error","overdueElapsedTime","newFireTime","setTimeout","clearTimeout","useAccurateTimer","v","newIndex","newValue","curr","goBack","header","Book","book","to","nocover","background","backgroundSize","bookWrapper","author","zip","JsZip","EPub","metadata","flow","items","compiled","containerFile","mimeFile","rootFile","file","type","open","loadAsync","files","validateMimeTipe","validateRootFiles","parseRootFile","compileText","filename","result","filter","path","name","toLowerCase","findFile","async","trim","xmlData","parsedXML","parser","parse","ignoreAttributes","rootfiles","rootfile","rootFileInfo","XMLData","ignoreNameSpace","attributeNamePrefix","entries","package","parseMetadata","parseManifest","parseSpine","parseGuide","identifier","creator","description","date","language","publisher","manifest","pop","href","concat","r","DOMParser","parseFromString","documentElement","textContent","spine","itemref","idref","push","guide","reference","URL","createObjectURL","outputText","useFileInput","input","document","createElement","onchange","event","click","Library","onAdd","selectedFile","epub","res","onBookClick","add","listContainer","list","map","bottomMenu","App","component","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.e2b982fc.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__xRGQ3\",\"topLine\":\"styles_topLine__9Xzw9\",\"controls\":\"styles_controls__aw6aK\",\"button\":\"styles_button__1pqxT\",\"wordsPerMinute\":\"styles_wordsPerMinute__2rsVl\",\"stats\":\"styles_stats__2RUm0\",\"bar\":\"styles_bar__xDlIR\",\"bottom\":\"styles_bottom__1djMp\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__3L1DU\",\"book\":\"styles_book__3kr_u\",\"bookWrapper\":\"styles_bookWrapper__385Le\",\"title\":\"styles_title__2fozK\",\"author\":\"styles_author__1rUEC\",\"bottom\":\"styles_bottom__3ye7t\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__HUCkD\",\"header\":\"styles_header__3miEM\",\"title\":\"styles_title__1elQZ\",\"add\":\"styles_add__h5c36\",\"listContainer\":\"styles_listContainer__26jV9\",\"list\":\"styles_list__1Gvkp\",\"bottomMenu\":\"styles_bottomMenu__2YYEk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__1qrsw\",\"textPlayer\":\"styles_textPlayer__39i09\",\"text\":\"styles_text__1rirC\",\"selected\":\"styles_selected__305tA\",\"playing\":\"styles_playing__DnXTA\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"container\":\"styles_container__3TSyu\",\"header\":\"styles_header__IVFnk\",\"title\":\"styles_title__3z0vq\"};","import createCtx from '../../utils/context';\r\nimport localforage from 'localforage';\r\nimport { useCallback, useEffect, useState } from 'react';\r\n\r\ninterface IStorageProviderProps {\r\n    children: React.ReactNode;\r\n}\r\n\r\nexport interface IStorageSettings {\r\n    font: string;\r\n    fontSize: number;\r\n    wordsPerMinute: number;\r\n}\r\n\r\nexport interface IBookInfo {\r\n    id: string;\r\n    title: string;\r\n    author: string;\r\n\r\n    cover?: string;\r\n}\r\n\r\ninterface IBook {\r\n    id: string;\r\n    title: string;\r\n    author: string;\r\n    cover?: string;\r\n    ttc?: string;\r\n    completed?: number;\r\n}\r\n\r\ninterface IStorageContext {\r\n    loaded: boolean;\r\n\r\n    library: IBookInfo[];\r\n    settings: IStorageSettings;\r\n\r\n    addBook: (bookInfo: any) => void;\r\n    removeBook: (id: string) => void;\r\n\r\n    getBookContent: (id: string) => Promise<{\r\n        info: IBookInfo;\r\n        content: string;\r\n        currentWordIndex: number;\r\n    }>;\r\n\r\n    saveCurrentWordIndex: (id: string, index: number) => void;\r\n}\r\n\r\nconst defaultSettings = {\r\n    font: 'Helvetica',\r\n    fontSize: 16,\r\n    wordsPerMinute: 320,\r\n};\r\n\r\nconst [useStorageContext, Provider] = createCtx<IStorageContext>();\r\n\r\nconst StorageProvider = ({ children }: IStorageProviderProps) => {\r\n    const [loaded, setLoaded] = useState(false);\r\n    const [settings, setSettings] = useState<IStorageSettings>(defaultSettings);\r\n    const [library, setLibrary] = useState<IBookInfo[]>([]);\r\n\r\n    const loadSettings = useCallback(async () => {\r\n        const data = await localforage.getItem('settings');\r\n        if (!data) {\r\n            await localforage.setItem('settings', defaultSettings);\r\n            setSettings(defaultSettings);\r\n        } else {\r\n            setSettings(data as IStorageSettings);\r\n        }\r\n    }, []);\r\n\r\n    const loadLibrary = useCallback(async () => {\r\n        const data = await localforage.getItem('library');\r\n        setLibrary((data as any) || []);\r\n        setLoaded(true);\r\n    }, []);\r\n\r\n    //\r\n    const addBook = useCallback(\r\n        async (bookInfo: any) => {\r\n            const bookExist = library.find((item) => item.id === bookInfo.id);\r\n            if (bookExist) {\r\n                console.log('Book already exist');\r\n                return;\r\n            }\r\n\r\n            const { content, cover, ...info } = bookInfo;\r\n\r\n            const updatedLibrary = [...library, info];\r\n            await localforage.setItem('library', updatedLibrary);\r\n            setLibrary(updatedLibrary);\r\n\r\n            await localforage.setItem(bookInfo.id, content);\r\n        },\r\n        [library]\r\n    );\r\n    const removeBook = useCallback((id: string) => {}, []);\r\n\r\n    const getBookContent = useCallback(\r\n        async (id: string) => {\r\n            const content = (await localforage.getItem(id)) as string;\r\n            const info = library.find((item) => item.id === id)!;\r\n\r\n            const currentWordIndex = (await getCurrentWordIndex(id)) || 0;\r\n\r\n            return {\r\n                info,\r\n                content,\r\n                currentWordIndex,\r\n            };\r\n        },\r\n        [library]\r\n    );\r\n\r\n    const getCurrentWordIndex = useCallback((id: string) => {\r\n        return localforage.getItem(`${id}_index`) as unknown as number;\r\n    }, []);\r\n\r\n    const saveCurrentWordIndex = useCallback((id: string, index: number) => {\r\n        localforage.setItem(`${id}_index`, index);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        loadSettings();\r\n        loadLibrary();\r\n    }, [loadSettings, loadLibrary]);\r\n\r\n    return (\r\n        <Provider\r\n            value={{\r\n                loaded,\r\n\r\n                library,\r\n                settings,\r\n\r\n                addBook,\r\n                removeBook,\r\n\r\n                getBookContent,\r\n\r\n                saveCurrentWordIndex,\r\n            }}\r\n        >\r\n            {children}\r\n        </Provider>\r\n    );\r\n};\r\n\r\nexport { useStorageContext };\r\n\r\nexport default StorageProvider;\r\n","\r\nimport { createContext, useContext } from \"react\";\r\n\r\nexport default function createCtx<A extends {} | null>() {\r\n    const ctx = createContext<A | undefined>(undefined);\r\n    function useCtx() {\r\n        const c = useContext(ctx);\r\n        if (c === undefined) {\r\n            throw new Error('useCtx must be inside a Provider with a value');\r\n        }\r\n        return c;\r\n    }\r\n    return [useCtx, ctx.Provider] as const;\r\n}","\r\nimport { BrowserRouter as Router, } from 'react-router-dom';\r\nimport StorageProvider from './Storage';\r\n\r\ninterface IProvidersProps { \r\n    children: React.ReactNode;\r\n}\r\n\r\nconst Providers = ({ children }: IProvidersProps) => {\r\n    return (\r\n        <Router>\r\n            <StorageProvider>\r\n                {children}\r\n            </StorageProvider>\r\n        </Router>\r\n    )\r\n}\r\n\r\nexport default Providers;","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"currentColor\",\n  d: \"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z\"\n});\n\nfunction SvgCogSolid(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    \"aria-hidden\": \"true\",\n    focusable: \"false\",\n    \"data-prefix\": \"fas\",\n    \"data-icon\": \"cog\",\n    className: \"svg-inline--fa fa-cog fa-w-16\",\n    role: \"img\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 512 512\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgCogSolid);\nexport default __webpack_public_path__ + \"static/media/cog-solid.540ab5dc.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"currentColor\",\n  d: \"M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z\"\n});\n\nfunction SvgAngleLeftSolid(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    \"aria-hidden\": \"true\",\n    focusable: \"false\",\n    \"data-prefix\": \"fas\",\n    \"data-icon\": \"angle-left\",\n    className: \"svg-inline--fa fa-angle-left fa-w-8\",\n    role: \"img\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 256 512\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgAngleLeftSolid);\nexport default __webpack_public_path__ + \"static/media/angle-left-solid.e6b3ab3d.svg\";\nexport { ForwardRef as ReactComponent };","\r\nimport './styles.scss';\r\n\r\ninterface ISingleWordRender {\r\n    word: string;\r\n}\r\n\r\nfunction ORP(word: string){\r\n    var length = word.length;\r\n    while('\\n,.?!:;\"'.indexOf(word[--length]) !== -1);\r\n    switch(++length) {\r\n      case 0: case 1: return 0;\r\n      case 2: case 3: return 1;\r\n      default: return Math.floor(length / 2) - 1;\r\n    }\r\n}\r\n\r\nconst SingleWordRender = ({ word }: ISingleWordRender) => {\r\n\r\n    const split = ORP(word);\r\n    const length = word.length;\r\n    let lpad = '';\r\n    let rpad = '';\r\n\r\n    if (length === 2) {\r\n        rpad = \"\\u00A0\";\r\n    } else if (length === 1 || length === 3) {\r\n    } else if (length % 2) {\r\n        lpad = \"\".padStart(Math.floor(length / 2) - split + 1, \"\\u00A0\");\r\n    } else {\r\n        lpad = \"\".padStart(Math.floor(length / 2) - split, \"\\u00A0\");\r\n    }\r\n\r\n    return (\r\n        <div className=\"word\">\r\n            {lpad + word.substr(0, split)}\r\n            <span className=\"selected\">{word.substr(split, 1)}</span>\r\n            {word.substr(split + 1) + rpad}\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default SingleWordRender;\r\n\r\n","import { useCallback } from 'react';\r\nimport cn from 'classnames';\r\nimport SingleWordRender from '../SingleWordRender';\r\nimport styles from './styles.module.scss';\r\n\r\ninterface IBookPlayerProps {\r\n    isPlaying: boolean;\r\n    rawBookText: string;\r\n    bookText: string[];\r\n    currentWordIndex: number;\r\n    onPlayerClick: () => void;\r\n}\r\n\r\nconst clamp = (min: number, val: number, max: number) =>\r\n    Math.max(min, Math.min(val, max));\r\n\r\nconst BookPart = ({\r\n    bookText,\r\n    currentWordIndex,\r\n}: {\r\n    bookText: string[];\r\n    currentWordIndex: number;\r\n}) => {\r\n    const startIndex = Math.max(0, currentWordIndex - 100);\r\n    const stopIndex = Math.min(currentWordIndex + 100, bookText.length);\r\n\r\n    const leftPart = bookText.slice(startIndex, currentWordIndex - 1).join(' ');\r\n    const rightPart = bookText.slice(currentWordIndex + 1, stopIndex).join(' ');\r\n    console.log(bookText[currentWordIndex]);\r\n    return (\r\n        <div className={styles.text}>\r\n            {leftPart}\r\n            <span className={styles.selected}>\r\n                {' '}\r\n                {bookText[currentWordIndex]}{' '}\r\n            </span>\r\n            {rightPart}\r\n        </div>\r\n    );\r\n};\r\n\r\nconst BookPlayer = ({\r\n    isPlaying,\r\n    rawBookText,\r\n    bookText,\r\n    currentWordIndex,\r\n    onPlayerClick,\r\n}: IBookPlayerProps) => {\r\n    const onClickHandler = useCallback(() => {\r\n        if (isPlaying) {\r\n            onPlayerClick();\r\n        }\r\n    }, [isPlaying, onPlayerClick]);\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <div\r\n                className={cn(styles.textPlayer, {\r\n                    [styles.playing]: isPlaying,\r\n                })}\r\n                onClick={onClickHandler}\r\n            >\r\n                {isPlaying ? (\r\n                    <SingleWordRender word={bookText[currentWordIndex]} />\r\n                ) : (\r\n                    <BookPart\r\n                        bookText={bookText}\r\n                        currentWordIndex={currentWordIndex}\r\n                    />\r\n                )}\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default BookPlayer;\r\n","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"currentColor\",\n  d: \"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z\"\n});\n\nfunction SvgMinusSolid(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    \"aria-hidden\": \"true\",\n    focusable: \"false\",\n    \"data-prefix\": \"fas\",\n    \"data-icon\": \"minus\",\n    className: \"svg-inline--fa fa-minus fa-w-14\",\n    role: \"img\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 448 512\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgMinusSolid);\nexport default __webpack_public_path__ + \"static/media/minus-solid.4d0790fe.svg\";\nexport { ForwardRef as ReactComponent };","function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nvar _ref2 = /*#__PURE__*/React.createElement(\"path\", {\n  fill: \"currentColor\",\n  d: \"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z\"\n});\n\nfunction SvgPlusSolid(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    \"aria-hidden\": \"true\",\n    focusable: \"false\",\n    \"data-prefix\": \"fas\",\n    \"data-icon\": \"plus\",\n    className: \"svg-inline--fa fa-plus fa-w-14\",\n    role: \"img\",\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 448 512\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _ref2);\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgPlusSolid);\nexport default __webpack_public_path__ + \"static/media/plus-solid.c82024f4.svg\";\nexport { ForwardRef as ReactComponent };","function secondsToStr(seconds1: number) {\r\n    var temp = seconds1;\r\n    var days = Math.floor((temp %= 31536000) / 86400);\r\n    if (days) {\r\n        return days + ' d';\r\n    }\r\n    var hours = Math.floor((temp %= 86400) / 3600);\r\n    if (hours) {\r\n        return hours + ' h';\r\n    }\r\n    var minutes = Math.floor((temp %= 3600) / 60);\r\n    if (minutes) {\r\n        return minutes + ' m';\r\n    }\r\n    var seconds = temp % 60;\r\n    if (seconds) {\r\n        return seconds + ' s';\r\n    }\r\n    return ''; //'just now' //or other string you like;\r\n}\r\n\r\nexport function completionRate(wordCount: number, currentWordIndex: number) {\r\n    return ((currentWordIndex / wordCount) * 100).toFixed(1);\r\n}\r\n\r\nexport function timeToRead(\r\n    wordCount: number,\r\n    currentWordIndex: number,\r\n    wordPerMinute: number\r\n) {\r\n    return secondsToStr(\r\n        Math.floor((wordCount - currentWordIndex) / (wordPerMinute / 60))\r\n    );\r\n}\r\n","import { ReactComponent as PlayIcon } from '../../assets/icons/play-solid.svg';\r\nimport { ReactComponent as PauseIcon } from '../../assets/icons/pause-solid.svg';\r\nimport { ReactComponent as MinusIcon } from '../../assets/icons/minus-solid.svg';\r\nimport { ReactComponent as PlusIcon } from '../../assets/icons/plus-solid.svg';\r\n\r\nimport styles from './styles.module.scss';\r\nimport { completionRate, timeToRead } from '../../utils/wordTime';\r\nimport { useCallback } from 'react';\r\n\r\ninterface IReaderControlsProps {\r\n    isPlaying: boolean;\r\n\r\n    speedDown: () => void;\r\n    speedUp: () => void;\r\n    togglePlay: () => void;\r\n\r\n    wordsCount: number;\r\n    currentIndex: number;\r\n    wordsPerMinute: number;\r\n}\r\n\r\nconst ReaderControls = ({\r\n    isPlaying,\r\n\r\n    speedDown,\r\n    speedUp,\r\n    togglePlay,\r\n\r\n    wordsCount,\r\n    currentIndex,\r\n    wordsPerMinute,\r\n}: IReaderControlsProps) => {\r\n    const completed = completionRate(wordsCount, currentIndex);\r\n    const ttr = timeToRead(wordsCount, currentIndex, wordsPerMinute);\r\n\r\n    const speedDownHanlder = useCallback((e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        speedDown();\r\n    }, [speedDown]);\r\n\r\n    const speedUpHanlder = useCallback((e: React.MouseEvent) => {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n        speedUp();\r\n    }, [speedUp]);\r\n\r\n    return (\r\n        <div className={styles.container} onClick={togglePlay}>\r\n            <div className={styles.topLine} />\r\n            <div className={styles.controls}>\r\n                <MinusIcon className={styles.button} onClick={speedDownHanlder} />\r\n                <div className={styles.wordsPerMinute}>{wordsPerMinute} <br /> word/m</div>\r\n                <PlusIcon className={styles.button} onClick={speedUpHanlder} />\r\n            </div>\r\n            <div className={styles.stats}>\r\n                <div className={styles.bar} style={{ '--total': `${completed}%` } as any} />\r\n                <div className={styles.bottom}>\r\n                    <div>{ttr}</div>\r\n                    <div>{completed}%</div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default ReaderControls;\r\n","import { useCallback, useEffect, useState } from 'react';\r\nimport { useHistory, useParams } from 'react-router-dom';\r\nimport { useStorageContext } from '../../Providers/Storage';\r\n\r\nimport { ReactComponent as CogIcon } from '../../assets/icons/cog-solid.svg';\r\nimport { ReactComponent as AngleLeft } from '../../assets/icons/angle-left-solid.svg';\r\n\r\nimport styles from './styles.module.scss';\r\nimport BookPlayer from '../../Components/BookPlayer';\r\nimport ReaderControls from '../../Components/ReaderControls';\r\n\r\ninterface TimerOptions {\r\n    delay: number;\r\n    callback: () => void;\r\n}\r\n\r\n/** Milliseconds representing forever in the future. */\r\nconst never = Number.MAX_SAFE_INTEGER;\r\n\r\nfunction useAccurateTimer(options: TimerOptions) {\r\n    const now = new Date().getTime();\r\n    const [started, setStarted] = useState(false);\r\n    // This is used to trigger a render that checks to fire the timer\r\n    const [, setCheckTime] = useState(now);\r\n    const [nextFireTime, setNextFireTime] = useState(never);\r\n\r\n    const isStarted = useCallback(() => started, [started]);\r\n    const isStopped = useCallback(() => !isStarted(), [isStarted]);\r\n\r\n    const start = useCallback(() => {\r\n        const currentTime = new Date().getTime();\r\n        const newNextFireTime = options.delay\r\n            ? Math.max(currentTime, currentTime)\r\n            : never;\r\n        setNextFireTime(newNextFireTime);\r\n        setStarted(true);\r\n    }, [options.delay]);\r\n\r\n    const stop = useCallback(() => {\r\n        setNextFireTime(never);\r\n        setStarted(false);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        let timeout: NodeJS.Timeout;\r\n\r\n        // If it's a timer and it isn't paused...\r\n        if (options.delay && !isStopped()) {\r\n            // Check if we're overdue on any events being fired (super low delay or expensive callback)\r\n            const overdueCalls = Math.max(\r\n                0,\r\n                Math.floor((now - nextFireTime) / options.delay)\r\n            );\r\n            // If we're overdue, this means we're not firing callbacks fast enough and need to prevent\r\n            // exceeding the maximum update depth.\r\n            // To do this, we only fire the callback on an even number of overdues (including 0, no overdues).\r\n            // Else, we wait a little, then try again.\r\n            if (overdueCalls % 2 !== 1) {\r\n                // If the timer is up...\r\n                if (now >= nextFireTime) {\r\n                    // Call the callback\r\n                    if (typeof options.callback === 'function') {\r\n                        try {\r\n                            options.callback();\r\n                        } catch (e) {\r\n                            console.error(e);\r\n                        }\r\n                    }\r\n                    // Calculate and set the next time the timer should fire\r\n                    const overdueElapsedTime = overdueCalls * options.delay;\r\n                    const newFireTime = Math.max(\r\n                        now,\r\n                        nextFireTime + options.delay + overdueElapsedTime\r\n                    );\r\n                    setNextFireTime(newFireTime);\r\n                    // Set a timeout to check and fire the timer when time's up\r\n                    timeout = setTimeout(() => {\r\n                        // This merely triggers a rerender to check if the timer can fire.\r\n                        setCheckTime(new Date().getTime());\r\n                    }, Math.max(newFireTime - new Date().getTime(), 1));\r\n                }\r\n                // Time is not up yet. Set a timeout to check and fire when time's up\r\n                else if (nextFireTime < never) {\r\n                    timeout = setTimeout(() => {\r\n                        // This merely triggers a rerender to check if the timer can fire.\r\n                        setCheckTime(new Date().getTime());\r\n                        // Home in on the exact time to fire.\r\n                    }, Math.max(nextFireTime - new Date().getTime(), 1));\r\n                }\r\n            } else {\r\n                // Relief valve to avoid maximum update depth exceeded errors.\r\n                // When calls become overdue, there's too expensive of a callback or too low of a delay to keep up.\r\n                // In both cases, the React max update stack will be exceeded due to repeated firings.\r\n                // To relieve this, don't check to fire this time around, but check again in a short time.\r\n                timeout = setTimeout(() => {\r\n                    setCheckTime(new Date().getTime());\r\n                }, 20);\r\n            }\r\n        }\r\n\r\n        return () => {\r\n            clearTimeout(timeout);\r\n        };\r\n    }, [now, nextFireTime, isStopped, options.delay, options]);\r\n\r\n    return {\r\n        start,\r\n        stop,\r\n    };\r\n}\r\n\r\nconst Reader = () => {\r\n    const history = useHistory();\r\n\r\n    const [rawBookText, setRawBookText] = useState<string>('');\r\n    const [bookText, setBookText] = useState<string[]>([]);\r\n    const [currentWordIndex, setCurrentWordIndex] = useState(0);\r\n\r\n    const { id } = useParams<{ id: string }>();\r\n    const { loaded, getBookContent, saveCurrentWordIndex } =\r\n        useStorageContext();\r\n\r\n    const [title, setTitle] = useState('');\r\n\r\n    useEffect(() => {\r\n        if (!loaded) {\r\n            return;\r\n        }\r\n        getBookContent(id).then(({ info, content, currentWordIndex }) => {\r\n            setTitle(info.title);\r\n            setRawBookText(content);\r\n            setBookText(content.split(' '));\r\n            setCurrentWordIndex(currentWordIndex || 0);\r\n        });\r\n    }, [loaded, id]);\r\n\r\n    const [speed, setSpeed] = useState(320);\r\n    const [isPlaying, setPlaying] = useState(false);\r\n\r\n    const { start, stop } = useAccurateTimer({\r\n        delay: (60 / speed) * 1000,\r\n        callback: () => {\r\n            setCurrentWordIndex((v) => {\r\n                const newIndex = v + 1;\r\n                saveCurrentWordIndex(id, newIndex);\r\n                return newIndex;\r\n            });\r\n        },\r\n    });\r\n\r\n    const togglePlay = useCallback(\r\n        () =>\r\n            setPlaying((v) => {\r\n                let newValue = !v;\r\n                if (newValue) {\r\n                    start();\r\n                } else {\r\n                    stop();\r\n                }\r\n                return newValue;\r\n            }),\r\n        [start, stop]\r\n    );\r\n\r\n    const speedUp = useCallback(() => setSpeed((curr) => curr + 20), []);\r\n    const speedDown = useCallback(() => setSpeed((curr) => curr - 20), []);\r\n\r\n    const onPlayerClick = useCallback(() => {\r\n        togglePlay();\r\n    }, [togglePlay]);\r\n\r\n    const goBack = useCallback(() => {\r\n        history.goBack();\r\n    }, []);\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <div className={styles.header}>\r\n                <AngleLeft onClick={goBack} />\r\n                <div className={styles.title}>{title}</div>\r\n                <CogIcon />\r\n            </div>\r\n            <BookPlayer\r\n                isPlaying={isPlaying}\r\n                bookText={bookText}\r\n                currentWordIndex={currentWordIndex}\r\n                rawBookText={rawBookText}\r\n                onPlayerClick={onPlayerClick}\r\n            />\r\n            <ReaderControls\r\n                isPlaying={isPlaying}\r\n                currentIndex={currentWordIndex}\r\n                speedDown={speedDown}\r\n                speedUp={speedUp}\r\n                togglePlay={togglePlay}\r\n                wordsCount={bookText.length}\r\n                wordsPerMinute={speed}\r\n            />\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Reader;\r\n","import cn from 'classnames';\r\nimport { Link } from 'react-router-dom';\r\nimport { timeToRead, completionRate } from '../../utils/wordTime';\r\nimport styles from './styles.module.scss';\r\n\r\nimport { IBookInfo } from '../../Providers/Storage';\r\n\r\ninterface IBookProps {\r\n    book: IBookInfo;\r\n    stats: {\r\n        completed: string;\r\n        timeToRead: string;\r\n    };\r\n    onClick: (id: string) => void;\r\n}\r\n\r\nfunction Book({ book, stats, onClick }: IBookProps) {\r\n    const completed = completionRate(1500, 1000);\r\n    const ttr = timeToRead(1500, 1000, 320);\r\n\r\n    return (\r\n        <Link to={`/book/${book.id}`} className={styles.container}>\r\n            <div\r\n                className={cn(styles.book, { [styles.nocover]: !book.cover })}\r\n                style={\r\n                    book.cover\r\n                        ? {\r\n                            background: `url(${book.cover})`,\r\n                            backgroundSize: 'cover',\r\n                        }\r\n                        : {}\r\n                }\r\n            >\r\n                <div className={styles.bookWrapper}>\r\n                    <div className={styles.title}>{book.title}</div>\r\n                    <div className={styles.author}>{book.author}</div>\r\n                </div>\r\n            </div>\r\n            <div className={styles.bottom}>\r\n                <div>\r\n                    {stats.completed !== '100'\r\n                        ? `${stats.completed} %`\r\n                        : 'FINISHED'}\r\n                </div>\r\n                <div>{stats.timeToRead}</div>\r\n            </div>\r\n        </Link>\r\n    );\r\n}\r\n\r\nexport default Book;\r\n","\r\nimport JsZip from 'jszip';\r\nimport parser from 'fast-xml-parser';\r\n\r\nconst zip = new JsZip();\r\n\r\ninterface IMetadata {\r\n    id?: string;\r\n    publisher?: string;\r\n    language?: string;\r\n    title?: string;\r\n    subject?: string;\r\n    description?: string;\r\n    creator?: string;\r\n    date?: number;\r\n}\r\n\r\nclass EPub {\r\n\r\n    public cover: string | null = null;\r\n    public metadata: IMetadata = {};\r\n    public flow: string[] = [];\r\n    private items: {[key: string]: string}[] = [];\r\n    public compiled: string = \"\";\r\n\r\n    private containerFile: JsZip.JSZipObject | null = null;\r\n    private mimeFile: JsZip.JSZipObject | null = null;\r\n    private rootFile: JsZip.JSZipObject | null = null;\r\n\r\n    private file!: JsZip;\r\n    constructor(private data: Blob) {\r\n        if(data.type !== 'application/epub+zip') {\r\n            console.log(new Error(\"Not an Epub file\"))\r\n            return;\r\n        }\r\n    }\r\n\r\n    public async parse() {\r\n        return await this.open();\r\n    }\r\n\r\n    private async open() {\r\n        this.file = await zip.loadAsync(this.data);\r\n        // console.log(this.file)\r\n        \r\n        if(Object.keys(this.file.files).length === 0) {\r\n            console.log(new Error(\"No files in archive\"))\r\n            return;\r\n        }\r\n\r\n        await this.validateMimeTipe();\r\n        await this.validateRootFiles();\r\n        await this.parseRootFile();\r\n\r\n        await this.compileText();\r\n\r\n        // this.file.filter((path, file) => file.name)\r\n\r\n        return this.file;\r\n\r\n    }\r\n\r\n    private findFile(filename: string) {\r\n        const result = this.file.filter((path, file) => file.name.toLowerCase() === filename.toLowerCase());\r\n        if(result.length === 0) {\r\n            return null;\r\n        }\r\n        return result[0];\r\n    }\r\n\r\n    private async validateMimeTipe() {\r\n\r\n        this.mimeFile = this.findFile(\"mimetype\");\r\n        if(!this.mimeFile) {\r\n            console.log(new Error(\"No mimetype file in archive\"))\r\n            return;\r\n        }\r\n\r\n        const text = await this.mimeFile.async('text');\r\n\r\n        if(text.toLowerCase().trim() !== 'application/epub+zip') {\r\n            console.log(new Error(\"Unsupported mime type\"))\r\n            return;\r\n        }\r\n\r\n    }\r\n\r\n    private async validateRootFiles() {\r\n\r\n        this.containerFile = this.findFile(\"meta-inf/container.xml\");\r\n        if(!this.containerFile) {\r\n            console.log(new Error(\"No container file in archive\"));\r\n            return;\r\n        }\r\n\r\n        const xmlData = await this.containerFile.async('text');\r\n        const parsedXML = parser.parse(xmlData, { ignoreAttributes : false });\r\n\r\n        if (!parsedXML.container.rootfiles || !parsedXML.container.rootfiles.rootfile) {\r\n            console.log(new Error(\"No rootfiles found\"));\r\n            return;\r\n        }\r\n\r\n        const rootFileInfo = parsedXML.container.rootfiles.rootfile;\r\n        let filename: string;\r\n\r\n        if(rootFileInfo['@_media-type'] !== \"application/oebps-package+xml\" ) {\r\n            console.log(new Error(\"Rootfile in unknown format\"));\r\n            return;\r\n        }\r\n\r\n        filename = rootFileInfo['@_full-path'];\r\n\r\n        if(!filename) {\r\n            console.log(new Error(\"Empty rootfile\"));\r\n            return;\r\n        }\r\n\r\n        \r\n        this.rootFile = this.findFile(filename);\r\n        if(!this.rootFile) {\r\n            console.log(new Error(\"Rootfile not found from archive\"));\r\n            return;\r\n        }\r\n\r\n    }\r\n\r\n    private async parseRootFile() {\r\n\r\n        if(!this.rootFile) {\r\n            return;\r\n        }\r\n\r\n        const text = await this.rootFile.async('text');\r\n        const XMLData = parser.parse(text, { ignoreAttributes: false, ignoreNameSpace : true, attributeNamePrefix: '' });\r\n\r\n        for(const [key, value] of Object.entries(XMLData.package)) {\r\n            if(key === 'metadata') {\r\n                this.parseMetadata(value);\r\n            } else if(key === 'manifest') {\r\n                await this.parseManifest(value);\r\n            } else if(key === 'spine') {\r\n                this.parseSpine(value);\r\n            } else if(key === 'guide') {\r\n               await this.parseGuide(value);\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    private parseMetadata(metadata: any) {\r\n\r\n        for(const item of metadata.identifier) {\r\n            this.metadata.id = item['#text'];\r\n            break;\r\n        }\r\n        \r\n        this.metadata.creator = metadata.creator;\r\n        this.metadata.title = metadata.title;\r\n        this.metadata.description = metadata.description;\r\n        this.metadata.date = metadata.date;\r\n        this.metadata.language = metadata.language;\r\n        this.metadata.publisher = metadata.publisher;\r\n        this.metadata.title = metadata.title;\r\n\r\n    }\r\n\r\n    private async parseManifest(manifest: any) {\r\n    \r\n        const path = this.rootFile?.name.split(\"/\");\r\n        path?.pop();\r\n\r\n        const items: any = {};\r\n\r\n        for(const item of manifest.item) {\r\n            if(item['media-type'] === 'application/xhtml+xml') {\r\n                const href = path?.concat([item.href]).join('/');\r\n\r\n                const file = this.findFile(href!);\r\n                const r = await file?.async('text');\r\n                const text = new DOMParser().parseFromString(r!, \"text/xml\").documentElement.textContent;\r\n                \r\n                items[item.id] = text?.trim();\r\n            }\r\n        }\r\n\r\n        this.items = items;\r\n\r\n    }\r\n\r\n    private parseSpine(spine: any) {\r\n        if (spine.itemref) {\r\n            for(const { idref } of spine.itemref) {\r\n                this.flow.push(idref);\r\n            }\r\n        }\r\n    }\r\n\r\n    private async parseGuide(guide: any) {\r\n\r\n        if(!guide.reference || guide.reference.type !== 'cover') {\r\n            return;\r\n        }\r\n\r\n        const path = this.rootFile?.name.split(\"/\");\r\n        path?.pop();\r\n        const path_str = path?.join('/');\r\n\r\n        const href = path?.concat([guide.reference.href]).join('/');\r\n\r\n        if(!href) {\r\n            return;\r\n        }\r\n        const file = this.findFile(href);\r\n\r\n        if(!file) {\r\n            return;\r\n        }\r\n\r\n        const data = await file.async('blob');\r\n\r\n        this.cover = URL.createObjectURL(data);\r\n\r\n        \r\n    }\r\n\r\n    private async compileText() {\r\n\r\n        const outputText = [];\r\n\r\n        for(const id of this.flow) {\r\n            outputText.push((this.items as any)[id]);\r\n        }\r\n\r\n        this.compiled = outputText.join(' ');\r\n\r\n    }\r\n \r\n}\r\n\r\nexport default EPub;","import { useCallback } from \"react\";\r\n\r\nfunction useFileInput(options: any, callback: (files: File[]) => void) {\r\n\r\n    const onAction = useCallback(() => {\r\n        const input = document.createElement('input');\r\n        input.type = 'file';\r\n        input.onchange = (event) => {\r\n            if(!event.target || (event.target as any).files.length === 0) {\r\n                return callback([]);\r\n            }\r\n            callback((event.target as any).files);\r\n        }\r\n        input.click();\r\n    }, [callback]);\r\n    \r\n    return onAction;\r\n\r\n}\r\n\r\nexport default useFileInput;","import Book from '../../Components/Book';\r\nimport styles from './styles.module.scss';\r\nimport EPub from '../../Libraries/epub';\r\n\r\nimport { useStorageContext } from '../../Providers/Storage';\r\nimport useFileInput from '../../hooks/useFileInput';\r\nimport { useCallback } from 'react';\r\n\r\nimport { ReactComponent as PlusIcon } from '../../assets/icons/plus-solid.svg';\r\n\r\nconst Library = () => {\r\n    const { library, settings, addBook } = useStorageContext();\r\n\r\n    const onAdd = useFileInput({}, (files: File[]) => {\r\n        if (files.length === 0) {\r\n            return;\r\n        }\r\n\r\n        const selectedFile = files[0];\r\n        const epub = new EPub(selectedFile);\r\n        epub.parse().then((res) => {\r\n            if (!epub.metadata.id) {\r\n                return;\r\n            }\r\n\r\n            addBook({\r\n                id: epub.metadata.id,\r\n                title: epub.metadata.title,\r\n                author: epub.metadata.creator,\r\n                cover: epub.cover || undefined,\r\n                content: epub.compiled,\r\n            });\r\n        });\r\n    });\r\n\r\n    const onBookClick = useCallback((id: string) => {}, []);\r\n\r\n    return (\r\n        <div className={styles.container}>\r\n            <div className={styles.header}>\r\n                <div className={styles.title}>Library</div>\r\n                <div className={styles.add} onClick={onAdd}>\r\n                    <PlusIcon />\r\n                </div>\r\n            </div>\r\n            <div className={styles.listContainer}>\r\n                <div className={styles.list}>\r\n                    {library.map((book) => (\r\n                        <Book\r\n                            key={book.id}\r\n                            book={book}\r\n                            stats={{\r\n                                completed: '100',\r\n                                timeToRead: '1',\r\n                            }}\r\n                            onClick={onBookClick}\r\n                        />\r\n                    ))}\r\n                </div>\r\n            </div>\r\n            <div className={styles.bottomMenu}>\r\n                <div>Library</div>\r\n                <div>Settings</div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n\r\nexport default Library;\r\n","\r\nimport { Switch, Route } from 'react-router-dom';\r\nimport Providers from './Providers';\r\n\r\nimport Reader from './Pages/Reader';\r\nimport Library from './Pages/Library';\r\n\r\nimport './App.css';\r\n\r\nfunction App() {\r\n  return (\r\n    <Providers>\r\n      <Switch>\r\n        <Route path=\"/book/:id\" component={Reader} />\r\n        <Route path=\"/\" component={Library} />\r\n      </Switch>\r\n    </Providers>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport './index.css';\r\nimport App from './App';\r\nimport reportWebVitals from './reportWebVitals';\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}