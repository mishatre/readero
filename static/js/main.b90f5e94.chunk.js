(this.webpackJsonpreadero=this.webpackJsonpreadero||[]).push([[0],{12:function(e,t,n){e.exports={container:"styles_container__2wTvz",topLine:"styles_topLine__2_6vM",controls:"styles_controls__35G0Q",button:"styles_button__DEm4P",wordsPerMinute:"styles_wordsPerMinute__1W0_y",stats:"styles_stats__3X4yd",bar:"styles_bar__2-6X5",bottom:"styles_bottom__2_4JQ"}},15:function(e,t,n){e.exports={container:"styles_container__37Pj3",book:"styles_book__MO8h4",cover:"styles_cover__iveuQ",bookWrapper:"styles_bookWrapper__1h3J3",title:"styles_title__1byxz",author:"styles_author__1tkc1",bottom:"styles_bottom__lO9CU"}},16:function(e,t,n){e.exports={container:"styles_container__1Ej-K",header:"styles_header__2qrGJ",title:"styles_title__uPFBr",add:"styles_add__Ar1JF",listContainer:"styles_listContainer__ah3i7",list:"styles_list__2-5po",bottomMenu:"styles_bottomMenu__2VOH0"}},22:function(e,t,n){e.exports={container:"styles_container__3pbaN",textPlayer:"styles_textPlayer__28mO1",text:"styles_text__jtnD_",selected:"styles_selected__3er6P",playing:"styles_playing__2lA6K"}},32:function(e,t,n){e.exports={container:"styles_container__ifhOb",title:"styles_title__jOaLP"}},37:function(e,t,n){e.exports={container:"styles_container__2yWX5"}},44:function(e,t,n){},51:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(35),i=n.n(c),o=(n(44),n(3)),s=n(17),l=n(6),u=n(25),f=n(39),b=n(21),d=n(2),p=n.n(d),v=n(9),j=n(5);var O=n(11),x=n.n(O),h=n(1),m={font:"Helvetica",fontSize:16,wordsPerMinute:320},y=function(){var e=Object(r.createContext)(void 0);return[function(){var t=Object(r.useContext)(e);if(void 0===t)throw new Error("useCtx must be inside a Provider with a value");return t},e.Provider]}(),g=Object(j.a)(y,2),k=g[0],w=g[1],_=function(e){var t=e.children,n=Object(r.useState)(!1),a=Object(j.a)(n,2),c=a[0],i=a[1],o=Object(r.useState)(m),s=Object(j.a)(o,2),d=s[0],O=s[1],y=Object(r.useState)([]),g=Object(j.a)(y,2),k=g[0],_=g[1],C=Object(r.useCallback)(Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.getItem("settings");case 2:if(t=e.sent){e.next=9;break}return e.next=6,x.a.setItem("settings",m);case 6:O(m),e.next=10;break;case 9:O(t);case 10:case"end":return e.stop()}}),e)}))),[]),P=Object(r.useCallback)(Object(v.a)(p.a.mark((function e(){var t,n,r,a,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.getItem("library");case 2:t=e.sent,n=Object(b.a)(t||[]),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=14;break}return a=r.value,e.next=10,x.a.getItem("".concat(a.id,"_cover"));case 10:(c=e.sent)&&(a.cover=URL.createObjectURL(c));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),n.e(e.t0);case 19:return e.prev=19,n.f(),e.finish(19);case 22:console.log(t),_(t||[]),i(!0);case 25:case"end":return e.stop()}}),e,null,[[4,16,19,22]])}))),[]),N=Object(r.useCallback)(function(){var e=Object(v.a)(p.a.mark((function e(t){var n,r,a,c,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!k.find((function(e){return e.id===t.id}))){e.next=4;break}return console.log("Book already exist"),e.abrupt("return");case 4:return n=t.content,r=t.cover,a=Object(f.a)(t,["content","cover"]),e.next=7,x.a.setItem("library",[].concat(Object(u.a)(k),[a]));case 7:return _([].concat(Object(u.a)(k),[Object(l.a)(Object(l.a)({},a),{},{cover:r})])),e.next=10,x.a.setItem(t.id,n);case 10:if(!r){e.next=19;break}return e.next=13,fetch(r);case 13:return c=e.sent,e.next=16,c.blob();case 16:return i=e.sent,e.next=19,x.a.setItem("".concat(t.id,"_cover"),i);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[k]),E=Object(r.useCallback)((function(e){}),[]),M=Object(r.useCallback)(function(){var e=Object(v.a)(p.a.mark((function e(t){var n,r,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.getItem(t);case 2:return n=e.sent,r=k.find((function(e){return e.id===t})),e.next=6,I(t);case 6:if(e.t0=e.sent,e.t0){e.next=9;break}e.t0=0;case 9:return a=e.t0,e.abrupt("return",{info:r,content:n,currentWordIndex:a});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[k]),I=Object(r.useCallback)((function(e){return x.a.getItem("".concat(e,"_index"))}),[]),S=Object(r.useCallback)((function(e,t){x.a.setItem("".concat(e,"_index"),t)}),[]),T=Object(r.useCallback)((function(e){x.a.setItem("settings",Object(l.a)(Object(l.a)({},d),{},{wordsPerMinute:e})),O(Object(l.a)(Object(l.a)({},d),{},{wordsPerMinute:e}))}),[d]);return Object(r.useEffect)((function(){C(),P()}),[C,P]),Object(h.jsx)(w,{value:{loaded:c,library:k,settings:d,addBook:N,removeBook:E,getBookContent:M,saveCurrentWordIndex:S,saveCurrentSpeed:T},children:t})},C=function(e){var t=e.children;return Object(h.jsx)(s.a,{children:Object(h.jsx)(_,{children:t})})},P=n(37),N=n.n(P),E=n(14),M=n(27),I=n.n(M);n(51);var S=function(e){var t=e.word,n=function(e){for(var t=e.length;-1!=='\n,.?!:;"'.indexOf(e[--t]););switch(++t){case 0:case 1:return 0;case 2:case 3:return 1;default:return Math.floor(t/2)-1}}(t),r=t.length,a="",c="";return 2===r?c="\xa0":1===r||3===r||(a="".padStart(r%2?Math.floor(r/2)-n+1:Math.floor(r/2)-n,"\xa0")),Object(h.jsxs)("div",{className:"word",children:[a+t.substr(0,n),Object(h.jsx)("span",{className:"selected",children:t.substr(n,1)}),t.substr(n+1)+c]})},T=n(22),L=n.n(T),B=function(e){var t=e.bookText,n=e.currentWordIndex,r=Math.max(0,n-100),a=Math.min(n+100,t.length),c=t.slice(r,n-1).join(" "),i=t.slice(n+1,a).join(" ");return Object(h.jsxs)("div",{className:L.a.text,children:[c,Object(h.jsxs)("span",{className:L.a.selected,children:[" ",t[n]," "]}),i]})},D=function(e){var t=e.isPlaying,n=(e.rawBookText,e.bookText),a=e.currentWordIndex,c=e.onPlayerClick,i=Object(r.useCallback)((function(){t&&c()}),[t,c]);return Object(h.jsx)("div",{className:L.a.container,onClick:i,children:Object(h.jsx)("div",{className:I()(L.a.textPlayer,Object(E.a)({},L.a.playing,t)),children:t?Object(h.jsx)(S,{word:n[a]}):Object(h.jsx)(B,{bookText:n,currentWordIndex:a})})})};function A(){return(A=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function R(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var W=r.createElement("path",{fill:"currentColor",d:"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"});function z(e,t){var n=e.title,a=e.titleId,c=R(e,["title","titleId"]);return r.createElement("svg",A({"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"minus",className:"svg-inline--fa fa-minus fa-w-14",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",ref:t,"aria-labelledby":a},c),n?r.createElement("title",{id:a},n):null,W)}var F=r.forwardRef(z);n.p;function U(){return(U=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function H(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var J=r.createElement("path",{fill:"currentColor",d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"});function V(e,t){var n=e.title,a=e.titleId,c=H(e,["title","titleId"]);return r.createElement("svg",U({"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"plus",className:"svg-inline--fa fa-plus fa-w-14",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",ref:t,"aria-labelledby":a},c),n?r.createElement("title",{id:a},n):null,J)}var X=r.forwardRef(V),G=(n.p,n(12)),Q=n.n(G);function K(e,t){return(t/e*100).toFixed(1)}function q(e,t,n){return function(e){var t=e,n=Math.floor((t%=31536e3)/86400);if(n)return n+" d";var r=Math.floor((t%=86400)/3600);if(r)return r+" h";var a=Math.floor((t%=3600)/60);if(a)return a+" m";var c=t%60;return c?c+" s":""}(Math.floor((e-t)/(n/60)))}var Y=function(e){var t=e.isPlaying,n=e.speedDown,a=e.speedUp,c=e.togglePlay,i=e.wordsCount,o=e.currentIndex,s=e.wordsPerMinute,l=K(i,o),u=q(i,o,s),f=Object(r.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),n()}),[n]),b=Object(r.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),a()}),[a]);return t?null:Object(h.jsxs)("div",{className:Q.a.container,onClick:c,children:[Object(h.jsx)("div",{className:Q.a.topLine}),Object(h.jsxs)("div",{className:Q.a.controls,children:[Object(h.jsx)(F,{className:Q.a.button,onClick:f}),Object(h.jsxs)("div",{className:Q.a.wordsPerMinute,children:[s," ",Object(h.jsx)("br",{})," word/m"]}),Object(h.jsx)(X,{className:Q.a.button,onClick:b})]}),Object(h.jsxs)("div",{className:Q.a.stats,children:[Object(h.jsx)("div",{className:Q.a.bar,style:{"--total":"".concat(l,"%")}}),Object(h.jsxs)("div",{className:Q.a.bottom,children:[Object(h.jsx)("div",{children:u}),Object(h.jsxs)("div",{children:[l,"%"]})]})]})]})};function Z(){return(Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function $(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var ee=r.createElement("path",{fill:"currentColor",d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"});function te(e,t){var n=e.title,a=e.titleId,c=$(e,["title","titleId"]);return r.createElement("svg",Z({"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"cog",className:"svg-inline--fa fa-cog fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",ref:t,"aria-labelledby":a},c),n?r.createElement("title",{id:a},n):null,ee)}var ne=r.forwardRef(te);n.p;function re(){return(re=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function ae(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},c=Object.keys(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(r=0;r<c.length;r++)n=c[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var ce=r.createElement("path",{fill:"currentColor",d:"M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"});function ie(e,t){var n=e.title,a=e.titleId,c=ae(e,["title","titleId"]);return r.createElement("svg",re({"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"angle-left",className:"svg-inline--fa fa-angle-left fa-w-8",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 512",ref:t,"aria-labelledby":a},c),n?r.createElement("title",{id:a},n):null,ce)}var oe=r.forwardRef(ie),se=(n.p,n(32)),le=n.n(se),ue=function(e){e.isPlaying;var t=e.title,n=Object(o.f)(),a=Object(r.useCallback)((function(){return n.goBack()}),[n]);return Object(h.jsxs)("div",{className:le.a.container,children:[Object(h.jsx)(oe,{onClick:a}),Object(h.jsx)("div",{className:le.a.title,children:t}),Object(h.jsx)(ne,{})]})},fe=Number.MAX_SAFE_INTEGER;var be=function(){var e=Object(r.useState)(""),t=Object(j.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)([]),i=Object(j.a)(c,2),s=i[0],l=i[1],u=Object(r.useState)(0),f=Object(j.a)(u,2),b=f[0],d=f[1],p=Object(o.g)().id,v=k(),O=v.loaded,x=v.settings,m=v.getBookContent,y=v.saveCurrentWordIndex,g=v.saveCurrentSpeed,w=Object(r.useState)(""),_=Object(j.a)(w,2),C=_[0],P=_[1];Object(r.useEffect)((function(){O&&m(p).then((function(e){var t=e.info,n=e.content,r=e.currentWordIndex;P(t.title),a(n),l(n.replaceAll("\n"," ").split(" ")),d(r||0)}))}),[O,p]);var E=Object(r.useState)(x.wordsPerMinute),M=Object(j.a)(E,2),I=M[0],S=M[1],T=Object(r.useState)(!1),L=Object(j.a)(T,2),B=L[0],A=L[1];Object(r.useEffect)((function(){S(x.wordsPerMinute)}),[x.wordsPerMinute]);var R=function(e){var t=(new Date).getTime(),n=Object(r.useState)(!1),a=Object(j.a)(n,2),c=a[0],i=a[1],o=Object(r.useState)(t),s=Object(j.a)(o,2)[1],l=Object(r.useState)(fe),u=Object(j.a)(l,2),f=u[0],b=u[1],d=Object(r.useCallback)((function(){return c}),[c]),p=Object(r.useCallback)((function(){return!d()}),[d]),v=Object(r.useCallback)((function(){var t=(new Date).getTime(),n=e.delay?Math.max(t,t):fe;b(n),i(!0)}),[e.delay]),O=Object(r.useCallback)((function(){b(fe),i(!1)}),[]);return Object(r.useEffect)((function(){var n;if(e.delay&&!p()){var r=Math.max(0,Math.floor((t-f)/e.delay));if(r%2!==1)if(t>=f){var a=0;if("function"===typeof e.callback)try{a=e.callback()||0}catch(o){console.error(o)}var c=r*e.delay,i=Math.max(t,f+e.delay+c+a);b(i),n=setTimeout((function(){s((new Date).getTime())}),Math.max(i-(new Date).getTime(),1))}else f<fe&&(n=setTimeout((function(){s((new Date).getTime())}),Math.max(f-(new Date).getTime(),1)));else n=setTimeout((function(){s((new Date).getTime())}),20)}return function(){clearTimeout(n)}}),[t,f,p,e.delay,e]),{start:v,stop:O}}({delay:60/I*1e3,callback:function(){return d((function(e){var t=e+1;return y(p,t),t})),20*Math.max(0,s[b+1].length-10)}}),W=R.start,z=R.stop,F=Object(r.useCallback)((function(){return A((function(e){var t=!e;return t?W():z(),t}))}),[W,z]),U=Object(r.useCallback)((function(){S((function(e){return e+20})),g(I+20)}),[I]),H=Object(r.useCallback)((function(){S((function(e){return e-20})),g(I-20)}),[I]),J=Object(r.useCallback)((function(){F()}),[F]);return Object(h.jsxs)("div",{className:N.a.container,children:[Object(h.jsx)(ue,{isPlaying:B,title:C}),Object(h.jsx)(D,{isPlaying:B,bookText:s,currentWordIndex:b,rawBookText:n,onPlayerClick:J}),Object(h.jsx)(Y,{isPlaying:B,currentIndex:b,speedDown:H,speedUp:U,togglePlay:F,wordsCount:s.length,wordsPerMinute:I})]})},de=n(15),pe=n.n(de);var ve=function(e){var t,n=e.book,r=e.stats;return e.onClick,K(1500,1e3),q(1500,1e3,320),Object(h.jsxs)(s.b,{to:"/book/".concat(n.id),className:pe.a.container,children:[Object(h.jsx)("div",{className:I()(pe.a.book,(t={},Object(E.a)(t,pe.a.nocover,!n.cover),Object(E.a)(t,pe.a.cover,n.cover),t)),style:n.cover?{"--cover":"url(".concat(n.cover,")")}:{},children:!n.cover&&Object(h.jsxs)("div",{className:pe.a.bookWrapper,children:[Object(h.jsx)("div",{className:pe.a.title,children:n.title}),Object(h.jsx)("div",{className:pe.a.author,children:n.author})]})}),Object(h.jsxs)("div",{className:pe.a.bottom,children:[Object(h.jsx)("div",{children:"100"!==r.completed?"".concat(r.completed," %"):"FINISHED"}),Object(h.jsx)("div",{children:r.timeToRead})]})]})},je=n(16),Oe=n.n(je);var xe=function(e,t){return Object(r.useCallback)((function(){var e=document.createElement("input");e.type="file",e.onchange=function(e){if(!e.target||0===e.target.files.length)return t([]);t(e.target.files)},e.click()}),[t])},he=n(38),me=n.n(he),ye=n(33),ge=n.n(ye),ke=new me.a,we=new DOMParser;function _e(e,t){if(e.files[t])return e.files[t];var n=e.filter((function(e,n){return n.name.toLowerCase()===t.toLowerCase()}));return n.length>0?n[0]:null}function Ce(e){return Pe.apply(this,arguments)}function Pe(){return(Pe=Object(v.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=_e(t,"mimetype")){e.next=3;break}throw new Error("No mimetype file in archive");case 3:return e.next=5,n.async("text");case 5:if("application/epub+zip"===e.sent.toLowerCase().trim()){e.next=8;break}throw new Error("Unsupported mime type");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ne(e){return Ee.apply(this,arguments)}function Ee(){return(Ee=Object(v.a)(p.a.mark((function e(t){var n,r,a,c,i,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=_e(t,"meta-inf/container.xml")){e.next=3;break}throw new Error("No container file in archive");case 3:return e.next=5,n.async("text");case 5:if(r=e.sent,(a=ge.a.parse(r,{ignoreAttributes:!1})).container.rootfiles&&a.container.rootfiles.rootfile){e.next=9;break}throw new Error("No rootfiles found");case 9:if("application/oebps-package+xml"===(c=a.container.rootfiles.rootfile)["@_media-type"]){e.next=12;break}throw new Error("Rootfile in unknown format");case 12:if(i=c["@_full-path"]){e.next=15;break}throw new Error("Empty rootfile");case 15:if(o=_e(t,i)){e.next=18;break}throw new Error("Rootfile not found from archive");case 18:return e.abrupt("return",o);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Me(e,t){return Ie.apply(this,arguments)}function Ie(){return(Ie=Object(v.a)(p.a.mark((function e(t,n){var r,a,c,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.async("text");case 2:return r=e.sent,a=ge.a.parse(r,{ignoreAttributes:!1,ignoreNameSpace:!0,attributeNamePrefix:""}),(c=[]).push(Se(a.package.metadata)),c.push(De(a.package.guide,a.package,t,n)),c.push(Le(a.package,t,n)),e.next=10,Promise.all(c);case 10:return i=e.sent,e.abrupt("return",i.reduce((function(e,t){var n=t.key,r=t.value;return Object(l.a)(Object(l.a)({},e),{},Object(E.a)({},n,r))}),{}));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Se(e){return Te.apply(this,arguments)}function Te(){return(Te=Object(v.a)(p.a.mark((function e(t){var n,r,a,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n={},!Array.isArray(t.identifier)){e.next=21;break}r=Object(b.a)(t.identifier),e.prev=3,r.s();case 5:if((a=r.n()).done){e.next=11;break}return c=a.value,n.id=String(c["#text"]),e.abrupt("break",11);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),r.e(e.t0);case 16:return e.prev=16,r.f(),e.finish(16);case 19:e.next=22;break;case 21:n.id=String(t.identifier["#text"]);case 22:return n.id=n.id.replace("urn:uuid:",""),n.creator=t.creator,n.title=t.title,e.abrupt("return",{key:"metadata",value:n});case 26:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})))).apply(this,arguments)}function Le(e,t,n){return Be.apply(this,arguments)}function Be(){return(Be=Object(v.a)(p.a.mark((function e(t,n,r){var a,c,i,o,s,l,u,f,d,v,j,O,x,h,m,y,g;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t),a=[],t.spine.itemref){c=Object(b.a)(t.spine.itemref);try{for(o=function(){var e=i.value.idref,n=t.manifest.item.find((function(t){return t.id===e}));a.push(n.href)},c.s();!(i=c.n()).done;)o()}catch(p){c.e(p)}finally{c.f()}}if(0!==a.length){e.next=5;break}return e.abrupt("return",{key:"items",value:void 0});case 5:null===(s=null===r||void 0===r?void 0:r.name.split("/"))||void 0===s||s.pop(),l=[],u=0,f=a;case 9:if(!(u<f.length)){e.next=21;break}return d=f[u],v=null===s||void 0===s?void 0:s.concat([d]).join("/"),j=_e(n,v),e.next=15,null===j||void 0===j?void 0:j.async("text");case 15:O=e.sent,(x=we.parseFromString(O,"application/xhtml+xml").documentElement.textContent)&&""!==(g=null===x||void 0===x||null===(h=x.replaceAll("\n","."))||void 0===h||null===(m=h.replaceAll("?","?."))||void 0===m||null===(y=m.replaceAll("!","!."))||void 0===y?void 0:y.trim())&&l.push(g);case 18:u++,e.next=9;break;case 21:return e.abrupt("return",{key:"items",value:l});case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function De(e,t,n,r){return Ae.apply(this,arguments)}function Ae(){return(Ae=Object(v.a)(p.a.mark((function e(t,n,r,a){var c,i,o,s,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.reference&&"cover"===t.reference.type){e.next=2;break}return e.abrupt("return",{key:"cover",value:void 0});case 2:if(null===(c=null===a||void 0===a?void 0:a.name.split("/"))||void 0===c||c.pop(),i=null===c||void 0===c?void 0:c.concat([t.reference.href]).join("/")){e.next=7;break}return e.abrupt("return",{key:"cover",value:void 0});case 7:if(o=_e(r,i)){e.next=10;break}return e.abrupt("return",{key:"cover",value:void 0});case 10:return e.next=12,o.async("blob");case 12:return s=e.sent,l=n.manifest.item.find((function(e){return e.href===t.reference.href})),s=s.slice(0,s.size,l["media-type"]),e.abrupt("return",{key:"cover",value:URL.createObjectURL(s)});case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Re(e){var t,n=[],r=Object(b.a)(e);try{for(r.s();!(t=r.n()).done;){var a=t.value.split(".").map((function(e){return e.replaceAll("\u2014\xa0","\u2014\xa0").trim()})).filter((function(e){return""!==e}));n.push.apply(n,Object(u.a)(a))}}catch(c){r.e(c)}finally{r.f()}return n.join(" ")}function We(){return(We=Object(v.a)(p.a.mark((function e(t){var n,r,a,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("application/epub+zip"===t.type){e.next=2;break}throw new Error("Not an Epub file");case 2:return e.next=4,ke.loadAsync(t);case 4:if(n=e.sent,0!==Object.keys(n.files).length){e.next=7;break}throw new Error("No files in archive");case 7:return e.next=9,Ce(n);case 9:return e.next=11,Ne(n);case 11:return r=e.sent,e.next=14,Me(n,r);case 14:return a=e.sent,c=Re(a.items),delete a.items,a.content=c,e.abrupt("return",a);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ze=function(e){return We.apply(this,arguments)},Fe=function(){var e=k(),t=e.library,n=(e.settings,e.addBook),a=xe({},(function(e){if(0!==e.length){var t=e[0];ze(t).then((function(e){e.metadata.id&&n(Object(l.a)(Object(l.a)({},e.metadata),{},{cover:e.cover||void 0,content:e.content}))}))}})),c=Object(r.useCallback)((function(e){}),[]);return Object(h.jsxs)("div",{className:Oe.a.container,children:[Object(h.jsxs)("div",{className:Oe.a.header,children:[Object(h.jsx)("div",{className:Oe.a.title,children:"Library"}),Object(h.jsx)("div",{className:Oe.a.add,onClick:a,children:Object(h.jsx)(X,{})})]}),Object(h.jsx)("div",{className:Oe.a.listContainer,children:Object(h.jsx)("div",{className:Oe.a.list,children:t.map((function(e){return Object(h.jsx)(ve,{book:e,stats:{completed:"100",timeToRead:"1"},onClick:c},e.id)}))})}),Object(h.jsxs)("div",{className:Oe.a.bottomMenu,children:[Object(h.jsx)("div",{children:"Library"}),Object(h.jsx)("div",{children:"Settings"})]})]})};n(65);var Ue=function(){return Object(h.jsx)(C,{children:Object(h.jsxs)(o.c,{children:[Object(h.jsx)(o.a,{path:"/book/:id",component:be}),Object(h.jsx)(o.a,{path:"/",component:Fe})]})})},He=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,67)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;n(e),r(e),a(e),c(e),i(e)}))};i.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(Ue,{})}),document.getElementById("root")),He()}},[[66,1,2]]]);
//# sourceMappingURL=main.b90f5e94.chunk.js.map