(this.webpackJsonpreadero=this.webpackJsonpreadero||[]).push([[0],{10:function(e,t,n){e.exports={container:"styles_container__xRGQ3",topLine:"styles_topLine__9Xzw9",controls:"styles_controls__aw6aK",button:"styles_button__1pqxT",wordsPerMinute:"styles_wordsPerMinute__2rsVl",stats:"styles_stats__2RUm0",bar:"styles_bar__xDlIR",bottom:"styles_bottom__1djMp"}},13:function(e,t,n){e.exports={container:"styles_container__3L1DU",book:"styles_book__3kr_u",bookWrapper:"styles_bookWrapper__385Le",title:"styles_title__2fozK",author:"styles_author__1rUEC",bottom:"styles_bottom__3ye7t"}},14:function(e,t,n){e.exports={container:"styles_container__HUCkD",header:"styles_header__3miEM",title:"styles_title__1elQZ",add:"styles_add__h5c36",listContainer:"styles_listContainer__26jV9",list:"styles_list__1Gvkp",bottomMenu:"styles_bottomMenu__2YYEk"}},19:function(e,t,n){e.exports={container:"styles_container__1qrsw",textPlayer:"styles_textPlayer__39i09",text:"styles_text__1rirC",selected:"styles_selected__305tA",playing:"styles_playing__DnXTA"}},26:function(e,t,n){e.exports={container:"styles_container__3TSyu",header:"styles_header__IVFnk",title:"styles_title__3z0vq"}},44:function(e,t,n){},51:function(e,t,n){},65:function(e,t,n){},66:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),i=n(33),c=n.n(i),s=(n(44),n(3)),o=n(17),l=n(38),u=n(39),f=n(2),d=n.n(f),b=n(6),p=n(5);var v=n(12),h=n.n(v),j=n(1),m={font:"Helvetica",fontSize:16,wordsPerMinute:320},x=function(){var e=Object(r.createContext)(void 0);return[function(){var t=Object(r.useContext)(e);if(void 0===t)throw new Error("useCtx must be inside a Provider with a value");return t},e.Provider]}(),O=Object(p.a)(x,2),y=O[0],k=O[1],g=function(e){var t=e.children,n=Object(r.useState)(!1),a=Object(p.a)(n,2),i=a[0],c=a[1],s=Object(r.useState)(m),o=Object(p.a)(s,2),f=o[0],v=o[1],x=Object(r.useState)([]),O=Object(p.a)(x,2),y=O[0],g=O[1],w=Object(r.useCallback)(Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.getItem("settings");case 2:if(t=e.sent){e.next=9;break}return e.next=6,h.a.setItem("settings",m);case 6:v(m),e.next=10;break;case 9:v(t);case 10:case"end":return e.stop()}}),e)}))),[]),_=Object(r.useCallback)(Object(b.a)(d.a.mark((function e(){var t;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.getItem("library");case 2:t=e.sent,g(t||[]),c(!0);case 5:case"end":return e.stop()}}),e)}))),[]),C=Object(r.useCallback)(function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!y.find((function(e){return e.id===t.id}))){e.next=4;break}return console.log("Book already exist"),e.abrupt("return");case 4:return n=t.content,t.cover,r=Object(u.a)(t,["content","cover"]),a=[].concat(Object(l.a)(y),[r]),e.next=8,h.a.setItem("library",a);case 8:return g(a),e.next=11,h.a.setItem(t.id,n);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[y]),N=Object(r.useCallback)((function(e){}),[]),E=Object(r.useCallback)(function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.a.getItem(t);case 2:return n=e.sent,r=y.find((function(e){return e.id===t})),e.next=6,M(t);case 6:if(e.t0=e.sent,e.t0){e.next=9;break}e.t0=0;case 9:return a=e.t0,e.abrupt("return",{info:r,content:n,currentWordIndex:a});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[y]),M=Object(r.useCallback)((function(e){return h.a.getItem("".concat(e,"_index"))}),[]),I=Object(r.useCallback)((function(e,t){h.a.setItem("".concat(e,"_index"),t)}),[]);return Object(r.useEffect)((function(){w(),_()}),[w,_]),Object(j.jsx)(k,{value:{loaded:i,library:y,settings:f,addBook:C,removeBook:N,getBookContent:E,saveCurrentWordIndex:I},children:t})},w=function(e){var t=e.children;return Object(j.jsx)(o.a,{children:Object(j.jsx)(g,{children:t})})};function _(){return(_=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function C(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var N=r.createElement("path",{fill:"currentColor",d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"});function E(e,t){var n=e.title,a=e.titleId,i=C(e,["title","titleId"]);return r.createElement("svg",_({"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"cog",className:"svg-inline--fa fa-cog fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",ref:t,"aria-labelledby":a},i),n?r.createElement("title",{id:a},n):null,N)}var M=r.forwardRef(E);n.p;function I(){return(I=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function P(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var F=r.createElement("path",{fill:"currentColor",d:"M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"});function S(e,t){var n=e.title,a=e.titleId,i=P(e,["title","titleId"]);return r.createElement("svg",I({"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"angle-left",className:"svg-inline--fa fa-angle-left fa-w-8",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 512",ref:t,"aria-labelledby":a},i),n?r.createElement("title",{id:a},n):null,F)}var T=r.forwardRef(S),L=(n.p,n(26)),D=n.n(L),R=n(24),B=n(25),z=n.n(B);n(51);var W=function(e){var t=e.word,n=function(e){for(var t=e.length;-1!=='\n,.?!:;"'.indexOf(e[--t]););switch(++t){case 0:case 1:return 0;case 2:case 3:return 1;default:return Math.floor(t/2)-1}}(t),r=t.length,a="",i="";return 2===r?i="\xa0":1===r||3===r||(a="".padStart(r%2?Math.floor(r/2)-n+1:Math.floor(r/2)-n,"\xa0")),Object(j.jsxs)("div",{className:"word",children:[a+t.substr(0,n),Object(j.jsx)("span",{className:"selected",children:t.substr(n,1)}),t.substr(n+1)+i]})},U=n(19),A=n.n(U),V=function(e){var t=e.bookText,n=e.currentWordIndex,r=Math.max(0,n-100),a=Math.min(n+100,t.length),i=t.slice(r,n-1).join(" "),c=t.slice(n+1,a).join(" ");return console.log(t[n]),Object(j.jsxs)("div",{className:A.a.text,children:[i,Object(j.jsxs)("span",{className:A.a.selected,children:[" ",t[n]," "]}),c]})},H=function(e){var t=e.isPlaying,n=(e.rawBookText,e.bookText),a=e.currentWordIndex,i=e.onPlayerClick,c=Object(r.useCallback)((function(){t&&i()}),[t,i]);return Object(j.jsx)("div",{className:A.a.container,children:Object(j.jsx)("div",{className:z()(A.a.textPlayer,Object(R.a)({},A.a.playing,t)),onClick:c,children:t?Object(j.jsx)(W,{word:n[a]}):Object(j.jsx)(V,{bookText:n,currentWordIndex:a})})})};function G(){return(G=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function q(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var X=r.createElement("path",{fill:"currentColor",d:"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"});function J(e,t){var n=e.title,a=e.titleId,i=q(e,["title","titleId"]);return r.createElement("svg",G({"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"minus",className:"svg-inline--fa fa-minus fa-w-14",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",ref:t,"aria-labelledby":a},i),n?r.createElement("title",{id:a},n):null,X)}var K=r.forwardRef(J);n.p;function Q(){return(Q=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Y(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var Z=r.createElement("path",{fill:"currentColor",d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"});function $(e,t){var n=e.title,a=e.titleId,i=Y(e,["title","titleId"]);return r.createElement("svg",Q({"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"plus",className:"svg-inline--fa fa-plus fa-w-14",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",ref:t,"aria-labelledby":a},i),n?r.createElement("title",{id:a},n):null,Z)}var ee=r.forwardRef($),te=(n.p,n(10)),ne=n.n(te);function re(e,t){return(t/e*100).toFixed(1)}function ae(e,t,n){return function(e){var t=e,n=Math.floor((t%=31536e3)/86400);if(n)return n+" d";var r=Math.floor((t%=86400)/3600);if(r)return r+" h";var a=Math.floor((t%=3600)/60);if(a)return a+" m";var i=t%60;return i?i+" s":""}(Math.floor((e-t)/(n/60)))}var ie=function(e){e.isPlaying;var t=e.speedDown,n=e.speedUp,a=e.togglePlay,i=e.wordsCount,c=e.currentIndex,s=e.wordsPerMinute,o=re(i,c),l=ae(i,c,s),u=Object(r.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),t()}),[t]),f=Object(r.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),n()}),[n]);return Object(j.jsxs)("div",{className:ne.a.container,onClick:a,children:[Object(j.jsx)("div",{className:ne.a.topLine}),Object(j.jsxs)("div",{className:ne.a.controls,children:[Object(j.jsx)(K,{className:ne.a.button,onClick:u}),Object(j.jsxs)("div",{className:ne.a.wordsPerMinute,children:[s," ",Object(j.jsx)("br",{})," word/m"]}),Object(j.jsx)(ee,{className:ne.a.button,onClick:f})]}),Object(j.jsxs)("div",{className:ne.a.stats,children:[Object(j.jsx)("div",{className:ne.a.bar,style:{"--total":"".concat(o,"%")}}),Object(j.jsxs)("div",{className:ne.a.bottom,children:[Object(j.jsx)("div",{children:l}),Object(j.jsxs)("div",{children:[o,"%"]})]})]})]})},ce=Number.MAX_SAFE_INTEGER;var se=function(){var e=Object(s.f)(),t=Object(r.useState)(""),n=Object(p.a)(t,2),a=n[0],i=n[1],c=Object(r.useState)([]),o=Object(p.a)(c,2),l=o[0],u=o[1],f=Object(r.useState)(0),d=Object(p.a)(f,2),b=d[0],v=d[1],h=Object(s.g)().id,m=y(),x=m.loaded,O=m.getBookContent,k=m.saveCurrentWordIndex,g=Object(r.useState)(""),w=Object(p.a)(g,2),_=w[0],C=w[1];Object(r.useEffect)((function(){x&&O(h).then((function(e){var t=e.info,n=e.content,r=e.currentWordIndex;C(t.title),i(n),u(n.split(" ")),v(r||0)}))}),[x,h]);var N=Object(r.useState)(320),E=Object(p.a)(N,2),I=E[0],P=E[1],F=Object(r.useState)(!1),S=Object(p.a)(F,2),L=S[0],R=S[1],B=function(e){var t=(new Date).getTime(),n=Object(r.useState)(!1),a=Object(p.a)(n,2),i=a[0],c=a[1],s=Object(r.useState)(t),o=Object(p.a)(s,2)[1],l=Object(r.useState)(ce),u=Object(p.a)(l,2),f=u[0],d=u[1],b=Object(r.useCallback)((function(){return i}),[i]),v=Object(r.useCallback)((function(){return!b()}),[b]),h=Object(r.useCallback)((function(){var t=(new Date).getTime(),n=e.delay?Math.max(t,t):ce;d(n),c(!0)}),[e.delay]),j=Object(r.useCallback)((function(){d(ce),c(!1)}),[]);return Object(r.useEffect)((function(){var n;if(e.delay&&!v()){var r=Math.max(0,Math.floor((t-f)/e.delay));if(r%2!==1)if(t>=f){if("function"===typeof e.callback)try{e.callback()}catch(c){console.error(c)}var a=r*e.delay,i=Math.max(t,f+e.delay+a);d(i),n=setTimeout((function(){o((new Date).getTime())}),Math.max(i-(new Date).getTime(),1))}else f<ce&&(n=setTimeout((function(){o((new Date).getTime())}),Math.max(f-(new Date).getTime(),1)));else n=setTimeout((function(){o((new Date).getTime())}),20)}return function(){clearTimeout(n)}}),[t,f,v,e.delay,e]),{start:h,stop:j}}({delay:60/I*1e3,callback:function(){v((function(e){var t=e+1;return k(h,t),t}))}}),z=B.start,W=B.stop,U=Object(r.useCallback)((function(){return R((function(e){var t=!e;return t?z():W(),t}))}),[z,W]),A=Object(r.useCallback)((function(){return P((function(e){return e+20}))}),[]),V=Object(r.useCallback)((function(){return P((function(e){return e-20}))}),[]),G=Object(r.useCallback)((function(){U()}),[U]),q=Object(r.useCallback)((function(){e.goBack()}),[]);return Object(j.jsxs)("div",{className:D.a.container,children:[Object(j.jsxs)("div",{className:D.a.header,children:[Object(j.jsx)(T,{onClick:q}),Object(j.jsx)("div",{className:D.a.title,children:_}),Object(j.jsx)(M,{})]}),Object(j.jsx)(H,{isPlaying:L,bookText:l,currentWordIndex:b,rawBookText:a,onPlayerClick:G}),Object(j.jsx)(ie,{isPlaying:L,currentIndex:b,speedDown:V,speedUp:A,togglePlay:U,wordsCount:l.length,wordsPerMinute:I})]})},oe=n(13),le=n.n(oe);var ue=function(e){var t=e.book,n=e.stats;return e.onClick,re(1500,1e3),ae(1500,1e3,320),Object(j.jsxs)(o.b,{to:"/book/".concat(t.id),className:le.a.container,children:[Object(j.jsx)("div",{className:z()(le.a.book,Object(R.a)({},le.a.nocover,!t.cover)),style:t.cover?{background:"url(".concat(t.cover,")"),backgroundSize:"cover"}:{},children:Object(j.jsxs)("div",{className:le.a.bookWrapper,children:[Object(j.jsx)("div",{className:le.a.title,children:t.title}),Object(j.jsx)("div",{className:le.a.author,children:t.author})]})}),Object(j.jsxs)("div",{className:le.a.bottom,children:[Object(j.jsx)("div",{children:"100"!==n.completed?"".concat(n.completed," %"):"FINISHED"}),Object(j.jsx)("div",{children:n.timeToRead})]})]})},fe=n(14),de=n.n(fe),be=n(22),pe=n(35),ve=n(36),he=n(37),je=n.n(he),me=n(31),xe=n.n(me),Oe=new je.a,ye=function(){function e(t){Object(pe.a)(this,e),this.data=t,this.cover=null,this.metadata={},this.flow=[],this.items=[],this.compiled="",this.containerFile=null,this.mimeFile=null,this.rootFile=null,this.file=void 0,"application/epub+zip"===t.type||console.log(new Error("Not an Epub file"))}return Object(ve.a)(e,[{key:"parse",value:function(){var e=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.open();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"open",value:function(){var e=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Oe.loadAsync(this.data);case 2:if(this.file=e.sent,0!==Object.keys(this.file.files).length){e.next=6;break}return console.log(new Error("No files in archive")),e.abrupt("return");case 6:return e.next=8,this.validateMimeTipe();case 8:return e.next=10,this.validateRootFiles();case 10:return e.next=12,this.parseRootFile();case 12:return e.next=14,this.compileText();case 14:return e.abrupt("return",this.file);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"findFile",value:function(e){var t=this.file.filter((function(t,n){return n.name.toLowerCase()===e.toLowerCase()}));return 0===t.length?null:t[0]}},{key:"validateMimeTipe",value:function(){var e=Object(b.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.mimeFile=this.findFile("mimetype"),this.mimeFile){e.next=4;break}return console.log(new Error("No mimetype file in archive")),e.abrupt("return");case 4:return e.next=6,this.mimeFile.async("text");case 6:if("application/epub+zip"===e.sent.toLowerCase().trim()){e.next=10;break}return console.log(new Error("Unsupported mime type")),e.abrupt("return");case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"validateRootFiles",value:function(){var e=Object(b.a)(d.a.mark((function e(){var t,n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.containerFile=this.findFile("meta-inf/container.xml"),this.containerFile){e.next=4;break}return console.log(new Error("No container file in archive")),e.abrupt("return");case 4:return e.next=6,this.containerFile.async("text");case 6:if(t=e.sent,(n=xe.a.parse(t,{ignoreAttributes:!1})).container.rootfiles&&n.container.rootfiles.rootfile){e.next=11;break}return console.log(new Error("No rootfiles found")),e.abrupt("return");case 11:if("application/oebps-package+xml"===(r=n.container.rootfiles.rootfile)["@_media-type"]){e.next=15;break}return console.log(new Error("Rootfile in unknown format")),e.abrupt("return");case 15:if(a=r["@_full-path"]){e.next=19;break}return console.log(new Error("Empty rootfile")),e.abrupt("return");case 19:if(this.rootFile=this.findFile(a),this.rootFile){e.next=23;break}return console.log(new Error("Rootfile not found from archive")),e.abrupt("return");case 23:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parseRootFile",value:function(){var e=Object(b.a)(d.a.mark((function e(){var t,n,r,a,i,c,s;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.rootFile){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.rootFile.async("text");case 4:t=e.sent,n=xe.a.parse(t,{ignoreAttributes:!1,ignoreNameSpace:!0,attributeNamePrefix:""}),r=0,a=Object.entries(n.package);case 7:if(!(r<a.length)){e.next=28;break}if(i=Object(p.a)(a[r],2),c=i[0],s=i[1],"metadata"!==c){e.next=13;break}this.parseMetadata(s),e.next=25;break;case 13:if("manifest"!==c){e.next=18;break}return e.next=16,this.parseManifest(s);case 16:e.next=25;break;case 18:if("spine"!==c){e.next=22;break}this.parseSpine(s),e.next=25;break;case 22:if("guide"!==c){e.next=25;break}return e.next=25,this.parseGuide(s);case 25:r++,e.next=7;break;case 28:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"parseMetadata",value:function(e){var t,n=Object(be.a)(e.identifier);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.metadata.id=r["#text"];break}}catch(a){n.e(a)}finally{n.f()}this.metadata.creator=e.creator,this.metadata.title=e.title,this.metadata.description=e.description,this.metadata.date=e.date,this.metadata.language=e.language,this.metadata.publisher=e.publisher,this.metadata.title=e.title}},{key:"parseManifest",value:function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r,a,i,c,s,o,l,u,f;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(r=null===(n=this.rootFile)||void 0===n?void 0:n.name.split("/"))||void 0===r||r.pop(),a={},i=Object(be.a)(t.item),e.prev=4,i.s();case 6:if((c=i.n()).done){e.next=18;break}if("application/xhtml+xml"!==(s=c.value)["media-type"]){e.next=16;break}return o=null===r||void 0===r?void 0:r.concat([s.href]).join("/"),l=this.findFile(o),e.next=13,null===l||void 0===l?void 0:l.async("text");case 13:u=e.sent,f=(new DOMParser).parseFromString(u,"text/xml").documentElement.textContent,a[s.id]=null===f||void 0===f?void 0:f.trim();case 16:e.next=6;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(4),i.e(e.t0);case 23:return e.prev=23,i.f(),e.finish(23);case 26:this.items=a;case 27:case"end":return e.stop()}}),e,this,[[4,20,23,26]])})));return function(t){return e.apply(this,arguments)}}()},{key:"parseSpine",value:function(e){if(e.itemref){var t,n=Object(be.a)(e.itemref);try{for(n.s();!(t=n.n()).done;){var r=t.value.idref;this.flow.push(r)}}catch(a){n.e(a)}finally{n.f()}}}},{key:"parseGuide",value:function(){var e=Object(b.a)(d.a.mark((function e(t){var n,r,a,i,c;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.reference&&"cover"===t.reference.type){e.next=2;break}return e.abrupt("return");case 2:if(null===(r=null===(n=this.rootFile)||void 0===n?void 0:n.name.split("/"))||void 0===r||r.pop(),null===r||void 0===r?void 0:r.join("/"),a=null===r||void 0===r?void 0:r.concat([t.reference.href]).join("/")){e.next=8;break}return e.abrupt("return");case 8:if(i=this.findFile(a)){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,i.async("blob");case 13:c=e.sent,this.cover=URL.createObjectURL(c);case 15:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"compileText",value:function(){var e=Object(b.a)(d.a.mark((function e(){var t,n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=Object(be.a)(this.flow);try{for(n.s();!(r=n.n()).done;)a=r.value,t.push(this.items[a])}catch(i){n.e(i)}finally{n.f()}this.compiled=t.join(" ");case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}();var ke=function(e,t){return Object(r.useCallback)((function(){var e=document.createElement("input");e.type="file",e.onchange=function(e){if(!e.target||0===e.target.files.length)return t([]);t(e.target.files)},e.click()}),[t])},ge=function(){var e=y(),t=e.library,n=(e.settings,e.addBook),a=ke({},(function(e){if(0!==e.length){var t=e[0],r=new ye(t);r.parse().then((function(e){r.metadata.id&&n({id:r.metadata.id,title:r.metadata.title,author:r.metadata.creator,cover:r.cover||void 0,content:r.compiled})}))}})),i=Object(r.useCallback)((function(e){}),[]);return Object(j.jsxs)("div",{className:de.a.container,children:[Object(j.jsxs)("div",{className:de.a.header,children:[Object(j.jsx)("div",{className:de.a.title,children:"Library"}),Object(j.jsx)("div",{className:de.a.add,onClick:a,children:Object(j.jsx)(ee,{})})]}),Object(j.jsx)("div",{className:de.a.listContainer,children:Object(j.jsx)("div",{className:de.a.list,children:t.map((function(e){return Object(j.jsx)(ue,{book:e,stats:{completed:"100",timeToRead:"1"},onClick:i},e.id)}))})}),Object(j.jsxs)("div",{className:de.a.bottomMenu,children:[Object(j.jsx)("div",{children:"Library"}),Object(j.jsx)("div",{children:"Settings"})]})]})};n(65);var we=function(){return Object(j.jsx)(w,{children:Object(j.jsxs)(s.c,{children:[Object(j.jsx)(s.a,{path:"/book/:id",component:se}),Object(j.jsx)(s.a,{path:"/",component:ge})]})})},_e=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,67)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,i=t.getLCP,c=t.getTTFB;n(e),r(e),a(e),i(e),c(e)}))};c.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(we,{})}),document.getElementById("root")),_e()}},[[66,1,2]]]);
//# sourceMappingURL=main.e2b982fc.chunk.js.map