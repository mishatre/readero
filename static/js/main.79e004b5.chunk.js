(this.webpackJsonpreadero=this.webpackJsonpreadero||[]).push([[0],{12:function(e,t,r){e.exports={container:"styles_container__xRGQ3",topLine:"styles_topLine__9Xzw9",controls:"styles_controls__aw6aK",button:"styles_button__1pqxT",wordsPerMinute:"styles_wordsPerMinute__2rsVl",stats:"styles_stats__2RUm0",bar:"styles_bar__xDlIR",bottom:"styles_bottom__1djMp"}},15:function(e,t,r){e.exports={container:"styles_container__3L1DU",book:"styles_book__3kr_u",cover:"styles_cover__6Uu98",bookWrapper:"styles_bookWrapper__385Le",title:"styles_title__2fozK",author:"styles_author__1rUEC",bottom:"styles_bottom__3ye7t"}},16:function(e,t,r){e.exports={container:"styles_container__HUCkD",header:"styles_header__3miEM",title:"styles_title__1elQZ",add:"styles_add__h5c36",listContainer:"styles_listContainer__26jV9",list:"styles_list__1Gvkp",bottomMenu:"styles_bottomMenu__2YYEk"}},22:function(e,t,r){e.exports={container:"styles_container__1qrsw",textPlayer:"styles_textPlayer__39i09",text:"styles_text__1rirC",selected:"styles_selected__305tA",playing:"styles_playing__DnXTA"}},28:function(e,t,r){e.exports={container:"styles_container__3TSyu",header:"styles_header__IVFnk",title:"styles_title__3z0vq"}},43:function(e,t,r){},50:function(e,t,r){},64:function(e,t,r){},65:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r.n(n),c=r(35),i=r.n(c),o=(r(43),r(3)),s=r(19),l=r(6),u=r(25),f=r(38),b=r(21),d=r(2),p=r.n(d),v=r(9),j=r(5);var x=r(11),O=r.n(x),h=r(1),m={font:"Helvetica",fontSize:16,wordsPerMinute:320},y=function(){var e=Object(n.createContext)(void 0);return[function(){var t=Object(n.useContext)(e);if(void 0===t)throw new Error("useCtx must be inside a Provider with a value");return t},e.Provider]}(),k=Object(j.a)(y,2),w=k[0],g=k[1],_=function(e){var t=e.children,r=Object(n.useState)(!1),a=Object(j.a)(r,2),c=a[0],i=a[1],o=Object(n.useState)(m),s=Object(j.a)(o,2),d=s[0],x=s[1],y=Object(n.useState)([]),k=Object(j.a)(y,2),w=k[0],_=k[1],C=Object(n.useCallback)(Object(v.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.getItem("settings");case 2:if(t=e.sent){e.next=9;break}return e.next=6,O.a.setItem("settings",m);case 6:x(m),e.next=10;break;case 9:x(t);case 10:case"end":return e.stop()}}),e)}))),[]),N=Object(n.useCallback)(Object(v.a)(p.a.mark((function e(){var t,r,n,a,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.getItem("library");case 2:t=e.sent,r=Object(b.a)(t||[]),e.prev=4,r.s();case 6:if((n=r.n()).done){e.next=14;break}return a=n.value,e.next=10,O.a.getItem("".concat(a.id,"_cover"));case 10:(c=e.sent)&&(a.cover=URL.createObjectURL(c));case 12:e.next=6;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(4),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:console.log(t),_(t||[]),i(!0);case 25:case"end":return e.stop()}}),e,null,[[4,16,19,22]])}))),[]),P=Object(n.useCallback)(function(){var e=Object(v.a)(p.a.mark((function e(t){var r,n,a,c,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!w.find((function(e){return e.id===t.id}))){e.next=4;break}return console.log("Book already exist"),e.abrupt("return");case 4:return r=t.content,n=t.cover,a=Object(f.a)(t,["content","cover"]),e.next=7,O.a.setItem("library",[].concat(Object(u.a)(w),[a]));case 7:return _([].concat(Object(u.a)(w),[Object(l.a)(Object(l.a)({},a),{},{cover:n})])),e.next=10,O.a.setItem(t.id,r);case 10:if(!n){e.next=19;break}return e.next=13,fetch(n);case 13:return c=e.sent,e.next=16,c.blob();case 16:return i=e.sent,e.next=19,O.a.setItem("".concat(t.id,"_cover"),i);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[w]),E=Object(n.useCallback)((function(e){}),[]),M=Object(n.useCallback)(function(){var e=Object(v.a)(p.a.mark((function e(t){var r,n,a;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,O.a.getItem(t);case 2:return r=e.sent,n=w.find((function(e){return e.id===t})),e.next=6,I(t);case 6:if(e.t0=e.sent,e.t0){e.next=9;break}e.t0=0;case 9:return a=e.t0,e.abrupt("return",{info:n,content:r,currentWordIndex:a});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[w]),I=Object(n.useCallback)((function(e){return O.a.getItem("".concat(e,"_index"))}),[]),S=Object(n.useCallback)((function(e,t){O.a.setItem("".concat(e,"_index"),t)}),[]),T=Object(n.useCallback)((function(e){O.a.setItem("settings",Object(l.a)(Object(l.a)({},d),{},{wordsPerMinute:e})),x(Object(l.a)(Object(l.a)({},d),{},{wordsPerMinute:e}))}),[d]);return Object(n.useEffect)((function(){C(),N()}),[C,N]),Object(h.jsx)(g,{value:{loaded:c,library:w,settings:d,addBook:P,removeBook:E,getBookContent:M,saveCurrentWordIndex:S,saveCurrentSpeed:T},children:t})},C=function(e){var t=e.children;return Object(h.jsx)(s.a,{children:Object(h.jsx)(_,{children:t})})};function N(){return(N=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function P(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},c=Object.keys(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var E=n.createElement("path",{fill:"currentColor",d:"M487.4 315.7l-42.6-24.6c4.3-23.2 4.3-47 0-70.2l42.6-24.6c4.9-2.8 7.1-8.6 5.5-14-11.1-35.6-30-67.8-54.7-94.6-3.8-4.1-10-5.1-14.8-2.3L380.8 110c-17.9-15.4-38.5-27.3-60.8-35.1V25.8c0-5.6-3.9-10.5-9.4-11.7-36.7-8.2-74.3-7.8-109.2 0-5.5 1.2-9.4 6.1-9.4 11.7V75c-22.2 7.9-42.8 19.8-60.8 35.1L88.7 85.5c-4.9-2.8-11-1.9-14.8 2.3-24.7 26.7-43.6 58.9-54.7 94.6-1.7 5.4.6 11.2 5.5 14L67.3 221c-4.3 23.2-4.3 47 0 70.2l-42.6 24.6c-4.9 2.8-7.1 8.6-5.5 14 11.1 35.6 30 67.8 54.7 94.6 3.8 4.1 10 5.1 14.8 2.3l42.6-24.6c17.9 15.4 38.5 27.3 60.8 35.1v49.2c0 5.6 3.9 10.5 9.4 11.7 36.7 8.2 74.3 7.8 109.2 0 5.5-1.2 9.4-6.1 9.4-11.7v-49.2c22.2-7.9 42.8-19.8 60.8-35.1l42.6 24.6c4.9 2.8 11 1.9 14.8-2.3 24.7-26.7 43.6-58.9 54.7-94.6 1.5-5.5-.7-11.3-5.6-14.1zM256 336c-44.1 0-80-35.9-80-80s35.9-80 80-80 80 35.9 80 80-35.9 80-80 80z"});function M(e,t){var r=e.title,a=e.titleId,c=P(e,["title","titleId"]);return n.createElement("svg",N({"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"cog",className:"svg-inline--fa fa-cog fa-w-16",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",ref:t,"aria-labelledby":a},c),r?n.createElement("title",{id:a},r):null,E)}var I=n.forwardRef(M);r.p;function S(){return(S=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function T(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},c=Object.keys(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var L=n.createElement("path",{fill:"currentColor",d:"M31.7 239l136-136c9.4-9.4 24.6-9.4 33.9 0l22.6 22.6c9.4 9.4 9.4 24.6 0 33.9L127.9 256l96.4 96.4c9.4 9.4 9.4 24.6 0 33.9L201.7 409c-9.4 9.4-24.6 9.4-33.9 0l-136-136c-9.5-9.4-9.5-24.6-.1-34z"});function D(e,t){var r=e.title,a=e.titleId,c=T(e,["title","titleId"]);return n.createElement("svg",S({"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"angle-left",className:"svg-inline--fa fa-angle-left fa-w-8",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 256 512",ref:t,"aria-labelledby":a},c),r?n.createElement("title",{id:a},r):null,L)}var R=n.forwardRef(D),B=(r.p,r(28)),A=r.n(B),z=r(14),U=r(27),W=r.n(U);r(50);var F=function(e){var t=e.word,r=function(e){for(var t=e.length;-1!=='\n,.?!:;"'.indexOf(e[--t]););switch(++t){case 0:case 1:return 0;case 2:case 3:return 1;default:return Math.floor(t/2)-1}}(t),n=t.length,a="",c="";return 2===n?c="\xa0":1===n||3===n||(a="".padStart(n%2?Math.floor(n/2)-r+1:Math.floor(n/2)-r,"\xa0")),Object(h.jsxs)("div",{className:"word",children:[a+t.substr(0,r),Object(h.jsx)("span",{className:"selected",children:t.substr(r,1)}),t.substr(r+1)+c]})},V=r(22),H=r.n(V),q=function(e){var t=e.bookText,r=e.currentWordIndex,n=Math.max(0,r-100),a=Math.min(r+100,t.length),c=t.slice(n,r-1).join(" "),i=t.slice(r+1,a).join(" ");return Object(h.jsxs)("div",{className:H.a.text,children:[c,Object(h.jsxs)("span",{className:H.a.selected,children:[" ",t[r]," "]}),i]})},G=function(e){var t=e.isPlaying,r=(e.rawBookText,e.bookText),a=e.currentWordIndex,c=e.onPlayerClick,i=Object(n.useCallback)((function(){t&&c()}),[t,c]);return Object(h.jsx)("div",{className:H.a.container,onClick:i,children:Object(h.jsx)("div",{className:W()(H.a.textPlayer,Object(z.a)({},H.a.playing,t)),children:t?Object(h.jsx)(F,{word:r[a]}):Object(h.jsx)(q,{bookText:r,currentWordIndex:a})})})};function X(){return(X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function J(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},c=Object.keys(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var K=n.createElement("path",{fill:"currentColor",d:"M416 208H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h384c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"});function Q(e,t){var r=e.title,a=e.titleId,c=J(e,["title","titleId"]);return n.createElement("svg",X({"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"minus",className:"svg-inline--fa fa-minus fa-w-14",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",ref:t,"aria-labelledby":a},c),r?n.createElement("title",{id:a},r):null,K)}var Y=n.forwardRef(Q);r.p;function Z(){return(Z=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e}).apply(this,arguments)}function $(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},c=Object.keys(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(n=0;n<c.length;n++)r=c[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var ee=n.createElement("path",{fill:"currentColor",d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"});function te(e,t){var r=e.title,a=e.titleId,c=$(e,["title","titleId"]);return n.createElement("svg",Z({"aria-hidden":"true",focusable:"false","data-prefix":"fas","data-icon":"plus",className:"svg-inline--fa fa-plus fa-w-14",role:"img",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 448 512",ref:t,"aria-labelledby":a},c),r?n.createElement("title",{id:a},r):null,ee)}var re=n.forwardRef(te),ne=(r.p,r(12)),ae=r.n(ne);function ce(e,t){return(t/e*100).toFixed(1)}function ie(e,t,r){return function(e){var t=e,r=Math.floor((t%=31536e3)/86400);if(r)return r+" d";var n=Math.floor((t%=86400)/3600);if(n)return n+" h";var a=Math.floor((t%=3600)/60);if(a)return a+" m";var c=t%60;return c?c+" s":""}(Math.floor((e-t)/(r/60)))}var oe=function(e){e.isPlaying;var t=e.speedDown,r=e.speedUp,a=e.togglePlay,c=e.wordsCount,i=e.currentIndex,o=e.wordsPerMinute,s=ce(c,i),l=ie(c,i,o),u=Object(n.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),t()}),[t]),f=Object(n.useCallback)((function(e){e.preventDefault(),e.stopPropagation(),r()}),[r]);return Object(h.jsxs)("div",{className:ae.a.container,onClick:a,children:[Object(h.jsx)("div",{className:ae.a.topLine}),Object(h.jsxs)("div",{className:ae.a.controls,children:[Object(h.jsx)(Y,{className:ae.a.button,onClick:u}),Object(h.jsxs)("div",{className:ae.a.wordsPerMinute,children:[o," ",Object(h.jsx)("br",{})," word/m"]}),Object(h.jsx)(re,{className:ae.a.button,onClick:f})]}),Object(h.jsxs)("div",{className:ae.a.stats,children:[Object(h.jsx)("div",{className:ae.a.bar,style:{"--total":"".concat(s,"%")}}),Object(h.jsxs)("div",{className:ae.a.bottom,children:[Object(h.jsx)("div",{children:l}),Object(h.jsxs)("div",{children:[s,"%"]})]})]})]})},se=Number.MAX_SAFE_INTEGER;var le=function(){var e=Object(o.f)(),t=Object(n.useState)(""),r=Object(j.a)(t,2),a=r[0],c=r[1],i=Object(n.useState)([]),s=Object(j.a)(i,2),l=s[0],u=s[1],f=Object(n.useState)(0),b=Object(j.a)(f,2),d=b[0],p=b[1],v=Object(o.g)().id,x=w(),O=x.loaded,m=x.settings,y=x.getBookContent,k=x.saveCurrentWordIndex,g=x.saveCurrentSpeed,_=Object(n.useState)(""),C=Object(j.a)(_,2),N=C[0],P=C[1];Object(n.useEffect)((function(){O&&y(v).then((function(e){var t=e.info,r=e.content,n=e.currentWordIndex;P(t.title),c(r),u(r.replaceAll("\n"," ").split(" ")),p(n||0)}))}),[O,v]);var E=Object(n.useState)(m.wordsPerMinute),M=Object(j.a)(E,2),S=M[0],T=M[1],L=Object(n.useState)(!1),D=Object(j.a)(L,2),B=D[0],z=D[1];Object(n.useEffect)((function(){T(m.wordsPerMinute)}),[m.wordsPerMinute]);var U=function(e){var t=(new Date).getTime(),r=Object(n.useState)(!1),a=Object(j.a)(r,2),c=a[0],i=a[1],o=Object(n.useState)(t),s=Object(j.a)(o,2)[1],l=Object(n.useState)(se),u=Object(j.a)(l,2),f=u[0],b=u[1],d=Object(n.useCallback)((function(){return c}),[c]),p=Object(n.useCallback)((function(){return!d()}),[d]),v=Object(n.useCallback)((function(){var t=(new Date).getTime(),r=e.delay?Math.max(t,t):se;b(r),i(!0)}),[e.delay]),x=Object(n.useCallback)((function(){b(se),i(!1)}),[]);return Object(n.useEffect)((function(){var r;if(e.delay&&!p()){var n=Math.max(0,Math.floor((t-f)/e.delay));if(n%2!==1)if(t>=f){var a=0;if("function"===typeof e.callback)try{a=e.callback()||0}catch(o){console.error(o)}var c=n*e.delay,i=Math.max(t,f+e.delay+c+a);b(i),r=setTimeout((function(){s((new Date).getTime())}),Math.max(i-(new Date).getTime(),1))}else f<se&&(r=setTimeout((function(){s((new Date).getTime())}),Math.max(f-(new Date).getTime(),1)));else r=setTimeout((function(){s((new Date).getTime())}),20)}return function(){clearTimeout(r)}}),[t,f,p,e.delay,e]),{start:v,stop:x}}({delay:60/S*1e3,callback:function(){return p((function(e){var t=e+1;return k(v,t),t})),console.log(20*Math.max(0,l[d+1].length-10)),20*Math.max(0,l[d+1].length-10)}}),W=U.start,F=U.stop,V=Object(n.useCallback)((function(){return z((function(e){var t=!e;return t?W():F(),t}))}),[W,F]),H=Object(n.useCallback)((function(){T((function(e){return e+20})),g(S+20)}),[S]),q=Object(n.useCallback)((function(){T((function(e){return e-20})),g(S-20)}),[S]),X=Object(n.useCallback)((function(){V()}),[V]),J=Object(n.useCallback)((function(){e.goBack()}),[]);return Object(h.jsxs)("div",{className:A.a.container,children:[!B&&Object(h.jsxs)("div",{className:A.a.header,children:[Object(h.jsx)(R,{onClick:J}),Object(h.jsx)("div",{className:A.a.title,children:N}),Object(h.jsx)(I,{})]}),Object(h.jsx)(G,{isPlaying:B,bookText:l,currentWordIndex:d,rawBookText:a,onPlayerClick:X}),!B&&Object(h.jsx)(oe,{isPlaying:B,currentIndex:d,speedDown:q,speedUp:H,togglePlay:V,wordsCount:l.length,wordsPerMinute:S})]})},ue=r(15),fe=r.n(ue);var be=function(e){var t,r=e.book,n=e.stats;return e.onClick,ce(1500,1e3),ie(1500,1e3,320),Object(h.jsxs)(s.b,{to:"/book/".concat(r.id),className:fe.a.container,children:[Object(h.jsx)("div",{className:W()(fe.a.book,(t={},Object(z.a)(t,fe.a.nocover,!r.cover),Object(z.a)(t,fe.a.cover,r.cover),t)),style:r.cover?{"--cover":"url(".concat(r.cover,")")}:{},children:!r.cover&&Object(h.jsxs)("div",{className:fe.a.bookWrapper,children:[Object(h.jsx)("div",{className:fe.a.title,children:r.title}),Object(h.jsx)("div",{className:fe.a.author,children:r.author})]})}),Object(h.jsxs)("div",{className:fe.a.bottom,children:[Object(h.jsx)("div",{children:"100"!==n.completed?"".concat(n.completed," %"):"FINISHED"}),Object(h.jsx)("div",{children:n.timeToRead})]})]})},de=r(16),pe=r.n(de);var ve=function(e,t){return Object(n.useCallback)((function(){var e=document.createElement("input");e.type="file",e.onchange=function(e){if(!e.target||0===e.target.files.length)return t([]);t(e.target.files)},e.click()}),[t])},je=r(37),xe=r.n(je),Oe=r(33),he=r.n(Oe),me=new xe.a;new DOMParser;function ye(e,t){if(e.files[t])return e.files[t];var r=e.filter((function(e,r){return r.name.toLowerCase()===t.toLowerCase()}));return r.length>0?r[0]:null}function ke(e){return we.apply(this,arguments)}function we(){return(we=Object(v.a)(p.a.mark((function e(t){var r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=ye(t,"mimetype")){e.next=3;break}throw new Error("No mimetype file in archive");case 3:return e.next=5,r.async("text");case 5:if("application/epub+zip"===e.sent.toLowerCase().trim()){e.next=8;break}throw new Error("Unsupported mime type");case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ge(e){return _e.apply(this,arguments)}function _e(){return(_e=Object(v.a)(p.a.mark((function e(t){var r,n,a,c,i,o;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=ye(t,"meta-inf/container.xml")){e.next=3;break}throw new Error("No container file in archive");case 3:return e.next=5,r.async("text");case 5:if(n=e.sent,(a=he.a.parse(n,{ignoreAttributes:!1})).container.rootfiles&&a.container.rootfiles.rootfile){e.next=9;break}throw new Error("No rootfiles found");case 9:if("application/oebps-package+xml"===(c=a.container.rootfiles.rootfile)["@_media-type"]){e.next=12;break}throw new Error("Rootfile in unknown format");case 12:if(i=c["@_full-path"]){e.next=15;break}throw new Error("Empty rootfile");case 15:if(o=ye(t,i)){e.next=18;break}throw new Error("Rootfile not found from archive");case 18:return e.abrupt("return",o);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ce(e,t){return Ne.apply(this,arguments)}function Ne(){return(Ne=Object(v.a)(p.a.mark((function e(t,r){var n,a,c,i;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.async("text");case 2:return n=e.sent,a=he.a.parse(n,{ignoreAttributes:!1,ignoreNameSpace:!0,attributeNamePrefix:""}),(c=[]).push(Pe(a.package.metadata)),c.push(Se(a.package.guide,a.package,t,r)),c.push(Me(a.package,t,r)),e.next=10,Promise.all(c);case 10:return i=e.sent,e.abrupt("return",i.reduce((function(e,t){var r=t.key,n=t.value;return Object(l.a)(Object(l.a)({},e),{},Object(z.a)({},r,n))}),{}));case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Pe(e){return Ee.apply(this,arguments)}function Ee(){return(Ee=Object(v.a)(p.a.mark((function e(t){var r,n,a,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},!Array.isArray(t.identifier)){e.next=21;break}n=Object(b.a)(t.identifier),e.prev=3,n.s();case 5:if((a=n.n()).done){e.next=11;break}return c=a.value,r.id=c["#text"],e.abrupt("break",11);case 9:e.next=5;break;case 11:e.next=16;break;case 13:e.prev=13,e.t0=e.catch(3),n.e(e.t0);case 16:return e.prev=16,n.f(),e.finish(16);case 19:e.next=22;break;case 21:r.id=t.identifier["#text"];case 22:return r.id=r.id.replace("urn:uuid:",""),r.creator=t.creator,r.title=t.title,e.abrupt("return",{key:"metadata",value:r});case 26:case"end":return e.stop()}}),e,null,[[3,13,16,19]])})))).apply(this,arguments)}function Me(e,t,r){return Ie.apply(this,arguments)}function Ie(){return(Ie=Object(v.a)(p.a.mark((function e(t,r,n){var a,c,i,o,s,l,u,f,d,v,j,x,O,h,m,y,k;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log(t),a=[],t.spine.itemref){c=Object(b.a)(t.spine.itemref);try{for(o=function(){var e=i.value.idref,r=t.manifest.item.find((function(t){return t.id===e}));a.push(r.href)},c.s();!(i=c.n()).done;)o()}catch(p){c.e(p)}finally{c.f()}}if(0!==a.length){e.next=5;break}return e.abrupt("return",{key:"items",value:void 0});case 5:null===(s=null===n||void 0===n?void 0:n.name.split("/"))||void 0===s||s.pop(),l=[],u=0,f=a;case 9:if(!(u<f.length)){e.next=21;break}return d=f[u],v=null===s||void 0===s?void 0:s.concat([d]).join("/"),j=ye(r,v),e.next=15,null===j||void 0===j?void 0:j.async("text");case 15:x=e.sent,(O=(new DOMParser).parseFromString(x,"application/xhtml+xml").documentElement.textContent)&&""!==(k=null===O||void 0===O||null===(h=O.replaceAll("\n","."))||void 0===h||null===(m=h.replaceAll("?","?."))||void 0===m||null===(y=m.replaceAll("!","!."))||void 0===y?void 0:y.trim())&&l.push(k);case 18:u++,e.next=9;break;case 21:return e.abrupt("return",{key:"items",value:l});case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Se(e,t,r,n){return Te.apply(this,arguments)}function Te(){return(Te=Object(v.a)(p.a.mark((function e(t,r,n,a){var c,i,o,s,l;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.reference&&"cover"===t.reference.type){e.next=2;break}return e.abrupt("return",{key:"cover",value:void 0});case 2:if(null===(c=null===a||void 0===a?void 0:a.name.split("/"))||void 0===c||c.pop(),i=null===c||void 0===c?void 0:c.concat([t.reference.href]).join("/")){e.next=7;break}return e.abrupt("return",{key:"cover",value:void 0});case 7:if(o=ye(n,i)){e.next=10;break}return e.abrupt("return",{key:"cover",value:void 0});case 10:return e.next=12,o.async("blob");case 12:return s=e.sent,l=r.manifest.item.find((function(e){return e.href===t.reference.href})),s=s.slice(0,s.size,l["media-type"]),e.abrupt("return",{key:"cover",value:URL.createObjectURL(s)});case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Le(e){var t,r=[],n=Object(b.a)(e);try{for(n.s();!(t=n.n()).done;){var a=t.value.split(".").map((function(e){return e.replaceAll("\u2014\xa0","\u2014\xa0").trim()})).filter((function(e){return""!==e}));r.push.apply(r,Object(u.a)(a))}}catch(c){n.e(c)}finally{n.f()}return r.join(" ")}function De(){return(De=Object(v.a)(p.a.mark((function e(t){var r,n,a,c;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("application/epub+zip"===t.type){e.next=2;break}throw new Error("Not an Epub file");case 2:return e.next=4,me.loadAsync(t);case 4:if(r=e.sent,0!==Object.keys(r.files).length){e.next=7;break}throw new Error("No files in archive");case 7:return e.next=9,ke(r);case 9:return e.next=11,ge(r);case 11:return n=e.sent,e.next=14,Ce(r,n);case 14:return a=e.sent,c=Le(a.items),delete a.items,a.content=c,e.abrupt("return",a);case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Re=function(e){return De.apply(this,arguments)},Be=function(){var e=w(),t=e.library,r=(e.settings,e.addBook),a=ve({},(function(e){if(0!==e.length){var t=e[0];Re(t).then((function(e){e.metadata.id&&r(Object(l.a)(Object(l.a)({},e.metadata),{},{cover:e.cover||void 0,content:e.content}))}))}})),c=Object(n.useCallback)((function(e){}),[]);return Object(h.jsxs)("div",{className:pe.a.container,children:[Object(h.jsxs)("div",{className:pe.a.header,children:[Object(h.jsx)("div",{className:pe.a.title,children:"Library"}),Object(h.jsx)("div",{className:pe.a.add,onClick:a,children:Object(h.jsx)(re,{})})]}),Object(h.jsx)("div",{className:pe.a.listContainer,children:Object(h.jsx)("div",{className:pe.a.list,children:t.map((function(e){return Object(h.jsx)(be,{book:e,stats:{completed:"100",timeToRead:"1"},onClick:c},e.id)}))})}),Object(h.jsxs)("div",{className:pe.a.bottomMenu,children:[Object(h.jsx)("div",{children:"Library"}),Object(h.jsx)("div",{children:"Settings"})]})]})};r(64);var Ae=function(){return Object(h.jsx)(C,{children:Object(h.jsxs)(o.c,{children:[Object(h.jsx)(o.a,{path:"/book/:id",component:le}),Object(h.jsx)(o.a,{path:"/",component:Be})]})})},ze=function(e){e&&e instanceof Function&&r.e(3).then(r.bind(null,66)).then((function(t){var r=t.getCLS,n=t.getFID,a=t.getFCP,c=t.getLCP,i=t.getTTFB;r(e),n(e),a(e),c(e),i(e)}))};i.a.render(Object(h.jsx)(a.a.StrictMode,{children:Object(h.jsx)(Ae,{})}),document.getElementById("root")),ze()}},[[65,1,2]]]);
//# sourceMappingURL=main.79e004b5.chunk.js.map